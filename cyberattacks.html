<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com https://api.allorigins.win https://corsproxy.io https://api.codetabs.com https://geocoding-api.open-meteo.com https://www.cisa.gov https://services.nvd.nist.gov https://threatfox-api.abuse.ch https://urlhaus-api.abuse.ch https://mb-api.abuse.ch; connect-src 'self' https://fonts.googleapis.com https://api.allorigins.win https://corsproxy.io https://api.codetabs.com https://geocoding-api.open-meteo.com https://www.cisa.gov https://services.nvd.nist.gov https://threatfox-api.abuse.ch https://urlhaus-api.abuse.ch https://mb-api.abuse.ch; font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;">
    <title>Cyberattack Emergency Preparedness - EmergencyEssentials</title>
    <meta name="description" content="Comprehensive cybersecurity preparedness guide with real-time threat monitoring, attack prevention strategies, and professional security recommendations.">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
           font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000000;
            color: #FFFFFF;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* Header */
        .header {
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 100;
            border-bottom: 1px solid #333333;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            letter-spacing: -0.5px;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 24px;
            align-items: center;
        }
        
        .nav-link {
            color: #CCCCCC;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover,
        .nav-link.active {
            color: #FFFFFF;
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 120px 0;
            background: linear-gradient(180deg, #000000 0%, #111111 100%);
            position: relative;
        }
        
        .hero h1 {
            font-size: 72px;
            font-weight: 300;
            margin-bottom: 24px;
            letter-spacing: -2px;
            line-height: 1.1;
        }
        
        .hero p {
            font-size: 24px;
            color: #CCCCCC;
            max-width: 600px;
            margin: 0 auto 40px;
            font-weight: 300;
        }
        
        .threat-level {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: #1a1a1a;
            border: 1px solid #333333;
            padding: 16px 24px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .threat-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #FF4444;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Real-Time Data Dashboard */
        .data-dashboard {
            background: #1a1a1a;
            border: 1px solid #333333;
            margin: 60px 0 40px 0;
            border-radius: 8px;
            overflow: hidden;
        }

        .dashboard-header {
            background: #111111;
            padding: 20px 40px;
            border-bottom: 1px solid #333333;
        }

        .dashboard-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #FFFFFF;
        }

        .dashboard-subtitle {
            color: #CCCCCC;
            font-size: 14px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0;
        }

        .data-card {
            background: #1a1a1a;
            border-right: 1px solid #333333;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .data-card:last-child {
            border-right: none;
        }

        .data-card:hover {
            background: #242424;
        }

        .clickable-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .clickable-card:hover {
            background: #242424;
            transform: translateY(-2px);
            border-color: #555555;
        }

        .data-label {
            font-size: 12px;
            color: #999999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .data-value {
            font-size: 32px;
            font-weight: 300;
            margin-bottom: 8px;
            line-height: 1;
        }

        .data-status {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 12px;
        }

        .data-detail {
            font-size: 12px;
            color: #CCCCCC;
            line-height: 1.4;
        }

        /* Status Colors */
        .status-normal { color: #44AA44; }
        .status-watch { color: #FFDD44; }
        .status-warning { color: #FFAA44; }
        .status-critical { color: #FF4444; }

        .card-exploits .data-value { color: #FF4444; }
        .card-malware .data-value { color: #FFAA44; }
        .card-urls .data-value { color: #44AAFF; }
        .card-threat .data-value { color: #FFDD44; }

        /* Update indicator */
        .update-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #44AA44;
            animation: pulse 2s infinite;
        }

        .updating {
            background: #FFAA44;
        }

        .error {
            background: #FF4444;
            animation: none;
        }

        /* Threat Intelligence Feed */
        .threat-feed {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 20px 0;
        }

        .threat-list {
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .threat-item {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .threat-item:hover {
            background: #242424;
            border-color: #666666;
        }

        .threat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .threat-type {
            font-weight: 600;
            color: #FFFFFF;
            flex-grow: 1;
        }

        .threat-severity {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 12px;
        }

        .threat-severity.critical {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            border: 1px solid #FF4444;
        }

        .threat-severity.high {
            background: rgba(255, 170, 68, 0.1);
            color: #FFAA44;
            border: 1px solid #FFAA44;
        }

        .threat-severity.medium {
            background: rgba(255, 221, 68, 0.1);
            color: #FFDD44;
            border: 1px solid #FFDD44;
        }

        .threat-severity.low {
            background: rgba(68, 170, 255, 0.1);
            color: #44AAFF;
            border: 1px solid #44AAFF;
        }

        .threat-details {
            font-size: 14px;
            color: #CCCCCC;
            margin-bottom: 8px;
        }

        .threat-meta {
            font-size: 12px;
            color: #999999;
        }

        /* CISA Alerts Styling */
        .cisa-alerts {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 20px 0;
        }

        .alerts-list {
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .alert-item {
            background: #161616;
            border: 1px solid #444444;
            border-left: 4px solid #FF4444;
            border-radius: 0 8px 8px 0;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .alert-item:hover {
            background: #242424;
            border-color: #666666;
        }

        .alert-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 8px;
        }

        .alert-meta {
            font-size: 12px;
            color: #999999;
            margin-bottom: 8px;
        }

        .alert-description {
            font-size: 14px;
            color: #CCCCCC;
            line-height: 1.5;
        }

        /* Personal Risk Assessment */
        .risk-assessment {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 20px 0;
        }

        .risk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .risk-card {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .risk-card:hover {
            background: #242424;
            border-color: #666666;
            transform: translateY(-2px);
        }

        .risk-label {
            font-size: 14px;
            color: #CCCCCC;
            margin-bottom: 8px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-value {
            font-size: 36px;
            font-weight: 300;
            color: #FFFFFF;
            margin-bottom: 4px;
            line-height: 1;
        }

        .risk-description {
            font-size: 14px;
            color: #999999;
            font-weight: 500;
        }

        .risk-low { color: #44AA44; }
        .risk-moderate { color: #FFDD44; }
        .risk-high { color: #FFAA44; }
        .risk-critical { color: #FF4444; }

        /* Location Controls */
        .location-controls {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .location-display {
            font-size: 16px;
            color: #CCCCCC;
            margin-bottom: 8px;
        }

        .city-selector {
            background: #1a1a1a;
            border: 1px solid #444444;
            color: #FFFFFF;
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 16px;
            margin: 16px 8px;
            min-width: 200px;
        }

        .city-selector:focus {
            outline: none;
            border-color: #FFFFFF;
        }

        .refresh-btn {
            background: transparent;
            border: 1px solid #FFFFFF;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }
        
        .refresh-btn:hover {
            background: #FFFFFF;
            color: #000000;
        }

        /* Equipment Grid */
        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 60px;
        }
        
        .equipment-card {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .equipment-card:hover {
            background: #2a2a2a;
            border-color: #555555;
            transform: translateY(-2px);
        }
        
        .equipment-priority {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .equipment-priority.critical {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            border: 1px solid #FF4444;
        }
        
        .equipment-priority.important {
            background: rgba(255, 170, 68, 0.1);
            color: #FFAA44;
            border: 1px solid #FFAA44;
        }
        
        .equipment-priority.recommended {
            background: rgba(68, 170, 255, 0.1);
            color: #44AAFF;
            border: 1px solid #44AAFF;
        }
        
        .equipment-icon {
            width: 24px;
            height: 24px;
            margin-bottom: 24px;
            stroke: #FFFFFF;
            stroke-width: 1.5;
            fill: none;
        }
        
        .equipment-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #FFFFFF;
        }
        
        .equipment-description {
            color: #CCCCCC;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .equipment-specs {
            font-size: 12px;
            color: #999999;
            background: #161616;
            padding: 12px;
            border-radius: 4px;
            border-left: 2px solid #333333;
        }
        
        .affiliate-link {
            display: inline-block;
            margin-top: 16px;
            background: #FF9900;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: background 0.3s ease;
        }
        
        .affiliate-link:hover {
            background: #E68900;
        }

        /* Emergency Contacts */
        .emergency-contacts {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 60px;
            margin: 30px 0;
        }
        
        .contacts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }
        
        .contact-card {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .contact-card:hover {
            background: #242424;
            border-color: #666666;
        }
        
        .contact-type {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #999999;
            margin-bottom: 8px;
        }
        
        .contact-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #FFFFFF;
        }
        
        .contact-number {
            font-size: 20px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }
        
        .contact-description {
            font-size: 14px;
            color: #CCCCCC;
            line-height: 1.5;
        }

        /* Call to Action */
        .cta-section {
            background: #FFFFFF;
            color: #000000;
            text-align: center;
            padding: 80px 40px;
            border-radius: 8px;
            margin: 40px 0;
        }
        
        .cta-title {
            font-size: 48px;
            font-weight: 300;
            margin-bottom: 16px;
            letter-spacing: -1px;
        }
        
        .cta-subtitle {
            font-size: 20px;
            margin-bottom: 32px;
            color: #666666;
            font-weight: 300;
        }
        
        .cta-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .cta-button {
            background: #000000;
            color: #FFFFFF;
            padding: 16px 32px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .cta-button:hover {
            background: #333333;
        }
        
        .cta-button.secondary {
            background: transparent;
            color: #000000;
            border: 1px solid #000000;
        }
        
        .cta-button.secondary:hover {
            background: #000000;
            color: #FFFFFF;
        }

        /* Section Styling */
        .section {
            padding: 60px 0;
        }
        
        .section-title {
            font-size: 56px;
            font-weight: 300;
            text-align: center;
            margin-bottom: 40px;
            color: #FFFFFF;
            letter-spacing: -1px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 48px;
            }
            
            .hero p {
                font-size: 18px;
            }
            
            .section-title {
                font-size: 36px;
            }
            
            .nav {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .cta-title {
                font-size: 32px;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .data-card {
                border-right: none;
                border-bottom: 1px solid #333333;
            }

            .data-card:last-child {
                border-bottom: none;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: fadeIn 0.6s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="index.html" class="logo">EmergencyEssentials</a>
                <div class="nav-links">
                    <a href="index.html" class="nav-link">All Emergencies</a>
                    <a href="wildfire.html" class="nav-link">Wildfire</a>
                    <a href="flood.html" class="nav-link">Flood</a>
                    <a href="#" class="nav-link">Power Outage</a>
                    <a href="earthquake.html" class="nav-link">Earthquake</a>
                    <a href="cyberattacks.html" class="nav-link active">Cyberattacks</a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Cyberattack Preparedness</h1>
            <p>Advanced cybersecurity defense strategies and real-time threat monitoring</p>
            <div class="threat-level">
                <div class="threat-indicator"></div>
                <span id="threat-level-text">Current Status: <strong>LOADING</strong> - Scanning threat landscape...</span>
            </div>
        </div>
    </section>

    <!-- Real-Time Data Dashboard -->
    <section class="section" style="padding: 40px 0;">
        <div class="container">
            <div class="data-dashboard">
                <div class="dashboard-header">
                    <h2 class="dashboard-title">🛡️ Live Cyber Threat Intelligence</h2>
                    <p class="dashboard-subtitle">Real-time cybersecurity threat monitoring and analysis</p>
                </div>
                <div class="dashboard-grid">
                    <div class="data-card card-exploits clickable-card" onclick="showExploitsDetail()">
                        <div class="update-indicator" id="exploits-indicator"></div>
                        <div class="data-label">Active Exploits</div>
                        <div class="data-value" id="exploits-count">Loading...</div>
                        <div class="data-status" id="exploits-status">Scanning CISA feed...</div>
                        <div class="data-detail" id="exploits-detail">Known exploited vulnerabilities</div>
                    </div>
                    
                    <div class="data-card card-malware clickable-card" onclick="showMalwareDetail()">
                        <div class="update-indicator" id="malware-indicator"></div>
                        <div class="data-label">Malware Threats</div>
                        <div class="data-value" id="malware-count">Loading...</div>
                        <div class="data-status" id="malware-status">Checking ThreatFox...</div>
                        <div class="data-detail" id="malware-detail">Recent IOCs and indicators</div>
                    </div>
                    
                    <div class="data-card card-urls clickable-card" onclick="showURLsDetail()">
                        <div class="update-indicator" id="urls-indicator"></div>
                        <div class="data-label">Malicious URLs</div>
                        <div class="data-value" id="urls-count">Loading...</div>
                        <div class="data-status" id="urls-status">Monitoring URLhaus...</div>
                        <div class="data-detail" id="urls-detail">Active malware distribution</div>
                    </div>
                    
                    <div class="data-card card-threat">
                        <div class="update-indicator" id="threat-indicator"></div>
                        <div class="data-label">Threat Level</div>
                        <div class="data-value" id="threat-level">Loading...</div>
                        <div class="data-status" id="threat-status">Calculating...</div>
                        <div class="data-detail" id="threat-detail">Overall cybersecurity risk</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Threat Intelligence Feed -->
    <section class="section">
        <div class="container">
            <div class="threat-feed">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Latest Threat Intelligence</h2>
                
                <div class="location-controls">
                    <div class="location-display">Source: <span id="threat-source">ThreatFox IOC Database</span></div>
                    <div class="location-display">Last Updated: <span id="threat-updated">Loading...</span></div>
                </div>
                
                <div id="threats-list" class="threat-list">
                    <div style="text-align: center; padding: 40px; color: #CCCCCC;">
                        <div style="font-size: 18px; margin-bottom: 8px;">Loading latest threat intelligence...</div>
                        <div style="color: #CCCCCC;">Fetching recent IOCs from threat intelligence feeds</div>
                    </div>
                </div>
                
                <button class="refresh-btn" onclick="refreshThreatFeed()">Refresh Threat Feed</button>
            </div>
        </div>
    </section>

    <!-- CISA Security Alerts -->
    <section class="section">
        <div class="container">
            <div class="cisa-alerts">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">CISA Security Alerts</h2>
                
                <div class="location-controls">
                    <div class="location-display">Source: <span id="cisa-source">US Cybersecurity & Infrastructure Security Agency</span></div>
                    <div class="location-display">Active Vulnerabilities: <span id="cisa-count">Loading...</span></div>
                </div>
                
                <div id="cisa-list" class="alerts-list">
                    <div style="text-align: center; padding: 40px; color: #CCCCCC;">
                        <div style="font-size: 18px; margin-bottom: 8px;">Loading CISA security alerts...</div>
                        <div style="color: #CCCCCC;">Fetching known exploited vulnerabilities</div>
                    </div>
                </div>
                
                <button class="refresh-btn" onclick="refreshCISAAlerts()">Refresh CISA Alerts</button>
            </div>
        </div>
    </section>

    <!-- Personal Cyber Risk Assessment -->
    <section class="section">
        <div class="container">
            <div class="risk-assessment">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Personal Cybersecurity Risk Assessment</h2>
                
                <div class="location-controls">
                    <div class="location-display">Assessment based on current threat landscape and common attack vectors</div>
                </div>
                
                <div class="risk-grid">
                    <div class="risk-card">
                        <div class="risk-label">Ransomware Risk</div>
                        <div class="risk-value risk-high" id="ransomware-risk">High</div>
                        <div class="risk-description" id="ransomware-desc">Based on current campaigns</div>
                    </div>
                    
                    <div class="risk-card">
                        <div class="risk-label">Phishing Threats</div>
                        <div class="risk-value risk-critical" id="phishing-risk">Critical</div>
                        <div class="risk-description">Email-based attacks prevalent</div>
                    </div>
                    
                    <div class="risk-card">
                        <div class="risk-label">Malware Exposure</div>
                        <div class="risk-value risk-moderate" id="malware-risk">Moderate</div>
                        <div class="risk-description" id="malware-desc">Based on recent samples</div>
                    </div>
                    
                    <div class="risk-card">
                        <div class="risk-label">Supply Chain</div>
                        <div class="risk-value risk-moderate" id="supply-risk">Moderate</div>
                        <div class="risk-description">Third-party vulnerabilities</div>
                    </div>
                </div>
                
                <button class="refresh-btn" onclick="refreshRiskAssessment()">Refresh Risk Assessment</button>
            </div>
        </div>
    </section>

    <!-- Cybersecurity Equipment -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Cybersecurity Defense Tools</h2>
            <div class="equipment-grid">
                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                    <h3 class="equipment-title">Password Manager</h3>
                    <p class="equipment-description">Enterprise-grade password manager with breach monitoring, secure password generation, and encrypted vault storage for all credentials.</p>
                    <div class="equipment-specs">
                        Specification: 256-bit encryption, multi-device sync, breach monitoring, 2FA integration
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('password-manager', 'amazon')">View Options - $2.99/month</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                    <h3 class="equipment-title">Hardware Security Key</h3>
                    <p class="equipment-description">FIDO2/WebAuthn hardware authentication key for phishing-resistant two-factor authentication on all important accounts.</p>
                    <div class="equipment-specs">
                        Specification: FIDO2/WebAuthn support, USB-C & NFC, waterproof, works with major services
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('security-key', 'amazon')">View on Amazon - $29.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"/>
                    </svg>
                    <h3 class="equipment-title">VPN Service</h3>
                    <p class="equipment-description">Privacy-focused VPN with no-logging policy, kill switch, and multi-device support for secure browsing and remote work protection.</p>
                    <div class="equipment-specs">
                        Specification: WireGuard protocol, no logs, kill switch, 5+ devices, global servers
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('vpn-service', 'amazon')">View Options - $3.99/month</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority important">Important</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/>
                    </svg>
                    <h3 class="equipment-title">Encrypted Backup Drive</h3>
                    <p class="equipment-description">Hardware-encrypted external drive with automatic backup software for protecting critical data against ransomware attacks.</p>
                    <div class="equipment-specs">
                        Specification: 1TB+ capacity, hardware AES-256 encryption, USB 3.0, backup software included
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('backup-drive', 'amazon')">View on Amazon - $149.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority important">Important</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"/>
                    </svg>
                    <h3 class="equipment-title">Privacy Webcam Cover</h3>
                    <p class="equipment-description">Physical webcam and microphone privacy controls to prevent unauthorized surveillance and protect against remote access attacks.</p>
                    <div class="equipment-specs">
                        Specification: Sliding cover, microphone mute switch, universal compatibility, ultra-thin design
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('webcam-cover', 'amazon')">View on Amazon - $12.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority recommended">Recommended</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z"/>
                    </svg>
                    <h3 class="equipment-title">Network Security Router</h3>
                    <p class="equipment-description">Enterprise-grade router with built-in firewall, intrusion detection, VPN support, and automatic security updates.</p>
                    <div class="equipment-specs">
                        Specification: WPA3 encryption, IDS/IPS, guest network, parental controls, auto-updates
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('security-router', 'amazon')">View on Amazon - $199.99</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Emergency Contacts -->
    <section class="section">
        <div class="container">
            <h2 class="section-title" id="emergency-contacts-title">Critical Cybersecurity Contacts</h2>
            <div class="emergency-contacts">
                <div class="location-controls">
                    <div class="location-display">Select your location for relevant emergency contacts:</div>
                    <select id="city-select" class="city-selector" onchange="updateContactsFromCitySelector()">
                        <option value="">Choose your city...</option>
                        <option value="33.4484,-112.0740">Phoenix, AZ</option>
                        <option value="34.0522,-118.2437">Los Angeles, CA</option>
                        <option value="37.7749,-122.4194">San Francisco, CA</option>
                        <option value="38.5816,-121.4944">Sacramento, CA</option>
                        <option value="39.7392,-104.9903">Denver, CO</option>
                        <option value="41.2033,-77.1945">Pennsylvania (State-wide)</option>
                        <option value="43.6532,-116.3113">Boise, ID</option>
                        <option value="41.8781,-87.6298">Chicago, IL</option>
                        <option value="39.7817,-86.1478">Indianapolis, IN</option>
                        <option value="38.2904,-92.6390">Missouri (State-wide)</option>
                        <option value="46.8772,-96.7898">Fargo, ND</option>
                        <option value="36.1627,-86.7816">Nashville, TN</option>
                        <option value="30.2672,-97.7431">Austin, TX</option>
                        <option value="32.7767,-96.7970">Dallas, TX</option>
                        <option value="29.7604,-95.3698">Houston, TX</option>
                        <option value="40.7608,-111.8910">Salt Lake City, UT</option>
                        <option value="47.0379,-122.9015">Olympia, WA</option>
                        <option value="47.6062,-122.3321">Seattle, WA</option>
                    </select>
                    <button class="refresh-btn" onclick="autoDetectLocation()">Auto-Detect Location</button>
                </div>
                
                <div id="emergency-contacts-grid" class="contacts-grid">
                    <!-- Default cybersecurity contacts -->
                    <div class="contact-card">
                        <div class="contact-type">Cyber Emergency</div>
                        <div class="contact-name">FBI Cyber Division</div>
                        <div class="contact-number">(855) 292-3937</div>
                        <div class="contact-description">Report cybercrimes and receive immediate assistance</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Government Cyber</div>
                        <div class="contact-name">CISA</div>
                        <div class="contact-number">(888) 282-0870</div>
                        <div class="contact-description">Cybersecurity and Infrastructure Security Agency hotline</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Identity Theft</div>
                        <div class="contact-name">FTC Identity Theft</div>
                        <div class="contact-number">(877) 438-4338</div>
                        <div class="contact-description">Federal Trade Commission identity theft reporting</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Financial Fraud</div>
                        <div class="contact-name">Your Bank</div>
                        <div class="contact-number">Check Bank Card</div>
                        <div class="contact-description">Report unauthorized transactions immediately</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Credit Monitoring</div>
                        <div class="contact-name">Credit Bureaus</div>
                        <div class="contact-number">(800) 525-6285</div>
                        <div class="contact-description">Experian fraud alert hotline (also contact Equifax & TransUnion)</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Local Support</div>
                        <div class="contact-name">IT Security Firm</div>
                        <div class="contact-number">Your Local Provider</div>
                        <div class="contact-description">Professional incident response and forensics</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="section">
        <div class="container">
            <div class="cta-section">
                <h2 class="cta-title">Create Your Cyber Defense Plan</h2>
                <p class="cta-subtitle">Generate a personalized cybersecurity action plan based on current threats and your risk profile</p>
                <div class="cta-buttons">
                    <button class="cta-button" onclick="generateCyberPlan()">Generate Plan</button>
                    <a href="#" class="cta-button secondary">Download Checklist</a>
                    <a href="#" class="cta-button secondary">Security Assessment</a>
                </div>
            </div>
        </div>
    </section>

    <script>
        // ================================
        // CYBERSECURITY THREAT DATA
        // ================================
        
        // Store live threat data
        let threatData = {
            exploits: [],
            malware: [],
            urls: [],
            cisa: [],
            lastUpdate: null
        };

        // ================================
        // API FETCH FUNCTIONS
        // ================================

        /**
         * Fetch CISA Known Exploited Vulnerabilities
         */
        async function fetchCISAExploits() {
            try {
                setIndicatorStatus('exploits-indicator', 'updating');
                updateStatus('exploits-status', 'Fetching CISA data...');
                
                // Use a CORS proxy to fetch CISA data
                const response = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json'));
                const data = await response.json();
                const cisaData = JSON.parse(data.contents);
                
                if (cisaData && cisaData.vulnerabilities) {
                    threatData.exploits = cisaData.vulnerabilities.slice(0, 10); // Latest 10
                    updateExploitsDisplay();
                    setIndicatorStatus('exploits-indicator', 'success');
                    updateStatus('exploits-status', 'CISA data updated');
                } else {
                    throw new Error('Invalid CISA data format');
                }
            } catch (error) {
                console.error('CISA fetch error:', error);
                setIndicatorStatus('exploits-indicator', 'error');
                updateStatus('exploits-status', 'CISA feed unavailable');
                // Use mock data as fallback
                threatData.exploits = generateMockCISAData();
                updateExploitsDisplay();
            }
        }

        /**
         * Fetch ThreatFox malware IOCs
         */
        async function fetchThreatFoxData() {
            try {
                setIndicatorStatus('malware-indicator', 'updating');
                updateStatus('malware-status', 'Querying ThreatFox...');
                
                // ThreatFox API endpoint for recent IOCs
                const response = await fetch('https://threatfox-api.abuse.ch/api/v1/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: 'get_iocs',
                        days: 7
                    })
                });
                
                const data = await response.json();
                
                if (data && data.query_status === 'ok' && data.data) {
                    threatData.malware = data.data.slice(0, 15); // Latest 15
                    updateMalwareDisplay();
                    setIndicatorStatus('malware-indicator', 'success');
                    updateStatus('malware-status', 'ThreatFox updated');
                } else {
                    throw new Error('ThreatFox API error');
                }
            } catch (error) {
                console.error('ThreatFox fetch error:', error);
                setIndicatorStatus('malware-indicator', 'error');
                updateStatus('malware-status', 'ThreatFox unavailable');
                // Use mock data as fallback
                threatData.malware = generateMockThreatFoxData();
                updateMalwareDisplay();
            }
        }

        /**
         * Fetch URLhaus malicious URLs
         */
        async function fetchURLhausData() {
            try {
                setIndicatorStatus('urls-indicator', 'updating');
                updateStatus('urls-status', 'Checking URLhaus...');
                
                // URLhaus API endpoint for recent URLs
                const response = await fetch('https://urlhaus-api.abuse.ch/api/v1/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: 'get_urls',
                        days: 3
                    })
                });
                
                const data = await response.json();
                
                if (data && data.query_status === 'ok' && data.urls) {
                    threatData.urls = data.urls.slice(0, 20); // Latest 20
                    updateURLsDisplay();
                    setIndicatorStatus('urls-indicator', 'success');
                    updateStatus('urls-status', 'URLhaus updated');
                } else {
                    throw new Error('URLhaus API error');
                }
            } catch (error) {
                console.error('URLhaus fetch error:', error);
                setIndicatorStatus('urls-indicator', 'error');
                updateStatus('urls-status', 'URLhaus unavailable');
                // Use mock data as fallback
                threatData.urls = generateMockURLhausData();
                updateURLsDisplay();
            }
        }

        // ================================
        // DISPLAY UPDATE FUNCTIONS
        // ================================

        /**
         * Update exploits dashboard card
         */
        function updateExploitsDisplay() {
            const count = threatData.exploits.length;
            document.getElementById('exploits-count').textContent = count;
            document.getElementById('exploits-detail').textContent = `${count} known exploited vulnerabilities`;
            
            // Update CISA alerts list
            updateCISAAlertsList();
        }

        /**
         * Update malware dashboard card
         */
        function updateMalwareDisplay() {
            const count = threatData.malware.length;
            document.getElementById('malware-count').textContent = count;
            document.getElementById('malware-detail').textContent = `${count} recent malware indicators`;
            
            // Update threat feed
            updateThreatFeedList();
        }

        /**
         * Update URLs dashboard card
         */
        function updateURLsDisplay() {
            const count = threatData.urls.length;
            document.getElementById('urls-count').textContent = count;
            document.getElementById('urls-detail').textContent = `${count} malicious URLs detected`;
        }

        /**
         * Update overall threat level
         */
        function updateThreatLevel() {
            const exploitCount = threatData.exploits.length;
            const malwareCount = threatData.malware.length;
            const urlCount = threatData.urls.length;
            
            let level, status, description, threatLevelText;
            
            if (exploitCount > 8 || malwareCount > 12 || urlCount > 15) {
                level = 'Critical';
                status = 'status-critical';
                description = 'High threat activity detected';
                threatLevelText = 'Current Status: <strong>CRITICAL</strong> - Multiple active threats detected';
            } else if (exploitCount > 5 || malwareCount > 8 || urlCount > 10) {
                level = 'High';
                status = 'status-warning';
                description = 'Elevated threat activity';
                threatLevelText = 'Current Status: <strong>HIGH</strong> - Elevated threat activity';
            } else if (exploitCount > 2 || malwareCount > 4 || urlCount > 5) {
                level = 'Moderate';
                status = 'status-watch';
                description = 'Normal threat levels';
                threatLevelText = 'Current Status: <strong>MODERATE</strong> - Normal threat levels';
            } else {
                level = 'Low';
                status = 'status-normal';
                description = 'Minimal threat activity';
                threatLevelText = 'Current Status: <strong>LOW</strong> - Minimal threat activity';
            }
            
            document.getElementById('threat-level').textContent = level;
            document.getElementById('threat-status').className = `data-status ${status}`;
            document.getElementById('threat-status').textContent = status.replace('status-', '').toUpperCase();
            document.getElementById('threat-detail').textContent = description;
            document.getElementById('threat-level-text').innerHTML = threatLevelText;
            
            setIndicatorStatus('threat-indicator', 'success');
        }

        /**
         * Update threat intelligence feed list
         */
        function updateThreatFeedList() {
            const container = document.getElementById('threats-list');
            if (!container || !threatData.malware.length) return;
            
            const html = threatData.malware.map(threat => {
                const severity = getThreatSeverity(threat.threat_type || 'unknown');
                const date = new Date(threat.first_seen || Date.now()).toLocaleDateString();
                
                return `
                    <div class="threat-item">
                        <div class="threat-header">
                            <div class="threat-type">${threat.threat_type || 'Unknown Threat'}</div>
                            <div class="threat-severity ${severity}">${severity}</div>
                        </div>
                        <div class="threat-details">${threat.malware || 'Malware detected'}: ${(threat.ioc || '').substring(0, 60)}...</div>
                        <div class="threat-meta">First seen: ${date} | Source: ${threat.reporter || 'ThreatFox'}</div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            document.getElementById('threat-updated').textContent = new Date().toLocaleString();
        }

        /**
         * Update CISA alerts list
         */
        function updateCISAAlertsList() {
            const container = document.getElementById('cisa-list');
            if (!container || !threatData.exploits.length) return;
            
            const html = threatData.exploits.map(alert => {
                const date = new Date(alert.dateAdded || Date.now()).toLocaleDateString();
                
                return `
                    <div class="alert-item">
                        <div class="alert-title">${alert.vulnerabilityName || 'Security Vulnerability'}</div>
                        <div class="alert-meta">CVE: ${alert.cveID || 'N/A'} | Added: ${date}</div>
                        <div class="alert-description">${alert.shortDescription || 'Known exploited vulnerability - patch immediately'}</div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            document.getElementById('cisa-count').textContent = threatData.exploits.length;
        }

        // ================================
        // UTILITY FUNCTIONS
        // ================================

        /**
         * Get threat severity based on type
         */
        function getThreatSeverity(threatType) {
            const type = threatType.toLowerCase();
            if (type.includes('ransomware') || type.includes('exploit')) return 'critical';
            if (type.includes('trojan') || type.includes('backdoor')) return 'high';
            if (type.includes('malware') || type.includes('virus')) return 'medium';
            return 'low';
        }

        /**
         * Set indicator status
         */
        function setIndicatorStatus(indicatorId, status) {
            const indicator = document.getElementById(indicatorId);
            if (!indicator) return;
            
            indicator.className = 'update-indicator';
            if (status === 'updating') {
                indicator.classList.add('updating');
            } else if (status === 'error') {
                indicator.classList.add('error');
            }
        }

        /**
         * Update status text
         */
        function updateStatus(elementId, text) {
            const element = document.getElementById(elementId);
            if (element) element.textContent = text;
        }

        // ================================
        // MOCK DATA GENERATORS
        // ================================

        function generateMockCISAData() {
            return [
                {
                    cveID: 'CVE-2024-0001',
                    vulnerabilityName: 'Microsoft Exchange Server Remote Code Execution',
                    dateAdded: '2024-01-15',
                    shortDescription: 'A remote code execution vulnerability exists in Microsoft Exchange Server when the server fails to properly validate authentication requests.'
                },
                {
                    cveID: 'CVE-2024-0002', 
                    vulnerabilityName: 'Apache HTTP Server Buffer Overflow',
                    dateAdded: '2024-01-14',
                    shortDescription: 'A buffer overflow vulnerability in Apache HTTP Server could allow remote attackers to execute arbitrary code.'
                },
                {
                    cveID: 'CVE-2024-0003',
                    vulnerabilityName: 'Cisco IOS XE Web UI Privilege Escalation',
                    dateAdded: '2024-01-13',
                    shortDescription: 'A privilege escalation vulnerability exists in the web-based user interface of Cisco IOS XE Software.'
                },
                {
                    cveID: 'CVE-2024-0004',
                    vulnerabilityName: 'VMware vCenter Server Authentication Bypass',
                    dateAdded: '2024-01-12',
                    shortDescription: 'An authentication bypass vulnerability in VMware vCenter Server allows unauthenticated attackers to gain administrative access.'
                },
                {
                    cveID: 'CVE-2024-0005',
                    vulnerabilityName: 'Windows Kernel Elevation of Privilege',
                    dateAdded: '2024-01-11',
                    shortDescription: 'An elevation of privilege vulnerability exists in the Windows kernel that could allow attackers to gain system privileges.'
                }
            ];
        }

        function generateMockThreatFoxData() {
            return [
                {
                    threat_type: 'ransomware',
                    malware: 'LockBit',
                    ioc: 'suspicious-domain.com/encrypt.exe',
                    first_seen: '2024-01-15T10:30:00Z',
                    reporter: 'ThreatFox'
                },
                {
                    threat_type: 'trojan',
                    malware: 'Emotet',
                    ioc: '192.168.1.100:8080/payload.bin',
                    first_seen: '2024-01-15T09:15:00Z',
                    reporter: 'SecurityTeam'
                },
                {
                    threat_type: 'backdoor',
                    malware: 'Cobalt Strike',
                    ioc: 'malicious-c2.net/beacon',
                    first_seen: '2024-01-15T08:45:00Z',
                    reporter: 'ThreatHunter'
                },
                {
                    threat_type: 'exploit_kit',
                    malware: 'RIG EK',
                    ioc: 'exploit-landing.org/kit.html',
                    first_seen: '2024-01-15T07:20:00Z',
                    reporter: 'MalwareBytes'
                },
                {
                    threat_type: 'info_stealer',
                    malware: 'RedLine',
                    ioc: 'stealer-panel.dark/login.php',
                    first_seen: '2024-01-15T06:10:00Z',
                    reporter: 'CyberSec'
                }
            ];
        }

        function generateMockURLhausData() {
            return [
                {
                    url: 'https://malicious-site.com/download.exe',
                    date_added: '2024-01-15',
                    threat: 'malware'
                },
                {
                    url: 'https://phishing-bank.net/secure-login.html',
                    date_added: '2024-01-15',
                    threat: 'phishing'
                },
                {
                    url: 'https://fake-update.org/flash-player.dmg',
                    date_added: '2024-01-14',
                    threat: 'malware'
                }
            ];
        }

        // ================================
        // RISK ASSESSMENT FUNCTIONS
        // ================================

        function updateRiskAssessment() {
            // Calculate ransomware risk based on current threats
            const ransomwareThreats = threatData.malware.filter(t => 
                (t.threat_type || '').toLowerCase().includes('ransomware')
            ).length;
            
            let ransomwareRisk, ransomwareClass, ransomwareDesc;
            if (ransomwareThreats > 3) {
                ransomwareRisk = 'Critical';
                ransomwareClass = 'risk-critical';
                ransomwareDesc = `${ransomwareThreats} active campaigns detected`;
            } else if (ransomwareThreats > 1) {
                ransomwareRisk = 'High';
                ransomwareClass = 'risk-high';
                ransomwareDesc = `${ransomwareThreats} campaigns active`;
            } else {
                ransomwareRisk = 'Moderate';
                ransomwareClass = 'risk-moderate';
                ransomwareDesc = 'Low activity levels';
            }
            
            document.getElementById('ransomware-risk').textContent = ransomwareRisk;
            document.getElementById('ransomware-risk').className = `risk-value ${ransomwareClass}`;
            document.getElementById('ransomware-desc').textContent = ransomwareDesc;
            
            // Calculate malware exposure based on recent samples
            const malwareCount = threatData.malware.length;
            let malwareRisk, malwareClass, malwareDesc;
            if (malwareCount > 12) {
                malwareRisk = 'High';
                malwareClass = 'risk-high';
                malwareDesc = `${malwareCount} recent samples detected`;
            } else if (malwareCount > 6) {
                malwareRisk = 'Moderate';
                malwareClass = 'risk-moderate';
                malwareDesc = `${malwareCount} samples in circulation`;
            } else {
                malwareRisk = 'Low';
                malwareClass = 'risk-low';
                malwareDesc = 'Minimal sample activity';
            }
            
            document.getElementById('malware-risk').textContent = malwareRisk;
            document.getElementById('malware-risk').className = `risk-value ${malwareClass}`;
            document.getElementById('malware-desc').textContent = malwareDesc;
        }

        // ================================
        // INTERACTIVE FUNCTIONS
        // ================================

        function showExploitsDetail() {
            alert(`CISA Known Exploited Vulnerabilities:\n\nTotal Active: ${threatData.exploits.length}\n\nThese are vulnerabilities that CISA has confirmed are being actively exploited in the wild. Immediate patching is critical.`);
        }

        function showMalwareDetail() {
            alert(`Active Malware Threats:\n\nRecent Samples: ${threatData.malware.length}\n\nThese are malware indicators detected in the last 7 days from threat intelligence feeds. Keep antivirus updated and avoid suspicious links.`);
        }

        function showURLsDetail() {
            alert(`Malicious URLs Detected:\n\nActive URLs: ${threatData.urls.length}\n\nThese URLs are actively distributing malware or hosting phishing content. Exercise extreme caution when browsing.`);
        }

        function refreshThreatFeed() {
            fetchThreatFoxData();
        }

        function refreshCISAAlerts() {
            fetchCISAExploits();
        }

        function refreshRiskAssessment() {
            updateRiskAssessment();
            alert('Risk assessment updated based on current threat intelligence.');
        }

        function generateCyberPlan() {
            const exploitCount = threatData.exploits.length;
            const malwareCount = threatData.malware.length;
            
            let plan = "🛡️ PERSONALIZED CYBER DEFENSE PLAN\n\n";
            plan += "IMMEDIATE ACTIONS:\n";
            plan += "✓ Enable automatic security updates\n";
            plan += "✓ Use strong, unique passwords with 2FA\n";
            plan += "✓ Backup critical data to offline storage\n\n";
            
            if (exploitCount > 5) {
                plan += "HIGH PRIORITY (Active Exploits Detected):\n";
                plan += "⚠️ Patch all systems immediately\n";
                plan += "⚠️ Review network access controls\n";
                plan += "⚠️ Monitor for unusual activity\n\n";
            }
            
            if (malwareCount > 8) {
                plan += "MALWARE PROTECTION:\n";
                plan += "🔒 Update antivirus definitions\n";
                plan += "🔒 Scan all systems for infections\n";
                plan += "🔒 Review email security settings\n\n";
            }
            
            plan += "WEEKLY TASKS:\n";
            plan += "• Review security logs\n";
            plan += "• Test backup integrity\n";
            plan += "• Update threat intelligence\n";
            plan += "• Security awareness training\n\n";
            
            plan += "Based on current threat level and your risk profile.";
            
            alert(plan);
        }

        function trackAffiliate(product, source) {
            console.log(`Affiliate click tracked: ${product} from ${source}`);
            // In a real implementation, this would track affiliate clicks
            alert(`Opening ${product} recommendations. Note: This is a demo - affiliate links would redirect to actual products.`);
        }

        // ================================
        // EMERGENCY CONTACTS DATABASE
        // ================================
        
        const EMERGENCY_CONTACTS_DB = {
            // Arizona
            'phoenix_az': {
                cityName: 'Phoenix, AZ',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Maricopa County Emergency Management',
                        number: '(602) 273-1411',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'APS Emergency Line',
                        number: '(855) 688-2437',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Phoenix IT Emergency',
                        number: '(602) 495-2999',
                        description: 'Local cybersecurity incident response team'
                    }
                ]
            },

            // California
            'los_angeles_ca': {
                cityName: 'Los Angeles, CA',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'LA County Emergency Management',
                        number: '(323) 881-2300',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'LADWP Emergency',
                        number: '(800) 342-5397',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'LA Cyber Response',
                        number: '(213) 978-1028',
                        description: 'Los Angeles cybersecurity emergency response'
                    }
                ]
            },

            'san_francisco_ca': {
                cityName: 'San Francisco, CA',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'SF Emergency Management',
                        number: '(415) 558-2700',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'PG&E Emergency Line',
                        number: '(800) 743-5000',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'SF Cyber Security',
                        number: '(415) 558-2700',
                        description: 'San Francisco cybersecurity incident response'
                    }
                ]
            },

            'sacramento_ca': {
                cityName: 'Sacramento, CA',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Sacramento County Emergency Services',
                        number: '(916) 874-6851',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'SMUD Emergency Line',
                        number: '(888) 456-7683',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Sacramento IT Emergency',
                        number: '(916) 808-5471',
                        description: 'Sacramento area cybersecurity support'
                    }
                ]
            },

            // Colorado
            'denver_co': {
                cityName: 'Denver, CO',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Jefferson County Sheriff',
                        number: '(303) 277-0211',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Xcel Energy',
                        number: '(800) 895-1999',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Denver Cyber Response',
                        number: '(720) 913-1311',
                        description: 'Denver area cybersecurity emergency support'
                    }
                ]
            },

            // Pennsylvania (State-wide)
            'pennsylvania': {
                cityName: 'Pennsylvania',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'PA Emergency Management',
                        number: '(717) 651-2001',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'PPL Electric Emergency',
                        number: '(800) 342-5775',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'PA Cyber Alliance',
                        number: '(717) 787-8997',
                        description: 'Pennsylvania cybersecurity alliance'
                    }
                ]
            },

            // Idaho
            'boise_id': {
                cityName: 'Boise, ID',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Ada County Emergency Management',
                        number: '(208) 577-4750',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Idaho Power Emergency',
                        number: '(208) 388-2323',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Boise IT Emergency',
                        number: '(208) 384-3904',
                        description: 'Boise area IT emergency support'
                    }
                ]
            },

            // Illinois
            'chicago_il': {
                cityName: 'Chicago, IL',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Chicago Emergency Management',
                        number: '(312) 746-5100',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'ComEd Emergency Line',
                        number: '(800) 334-7661',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Chicago Cyber Security',
                        number: '(312) 744-5000',
                        description: 'Chicago cybersecurity support services'
                    }
                ]
            },

            // Indiana
            'indianapolis_in': {
                cityName: 'Indianapolis, IN',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Marion County Emergency Management',
                        number: '(317) 327-3722',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Indianapolis Power & Light',
                        number: '(317) 261-8111',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Indianapolis IT Services',
                        number: '(317) 327-4622',
                        description: 'Indianapolis IT emergency support'
                    }
                ]
            },

            // Missouri (State-wide)
            'missouri': {
                cityName: 'Missouri',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'MO Emergency Management',
                        number: '(573) 526-9100',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Ameren Missouri Emergency',
                        number: '(800) 552-7583',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Missouri Cyber Alliance',
                        number: '(573) 751-4905',
                        description: 'Missouri cybersecurity coordination'
                    }
                ]
            },

            // North Dakota
            'fargo_nd': {
                cityName: 'Fargo, ND',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Cass County Emergency Management',
                        number: '(701) 241-5555',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Xcel Energy North Dakota',
                        number: '(800) 895-1999',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Fargo IT Emergency',
                        number: '(701) 241-1310',
                        description: 'Fargo area IT emergency support'
                    }
                ]
            },

            // Tennessee
            'nashville_tn': {
                cityName: 'Nashville, TN',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Davidson County Emergency Management',
                        number: '(615) 862-8740',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Nashville Electric Service',
                        number: '(615) 736-6900',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Nashville IT Services',
                        number: '(615) 862-6666',
                        description: 'Nashville cybersecurity support'
                    }
                ]
            },

            // Texas
            'austin_tx': {
                cityName: 'Austin, TX',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Travis County Emergency Services',
                        number: '(512) 854-4050',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Austin Energy Emergency',
                        number: '(512) 322-9100',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Austin Cyber Security',
                        number: '(512) 974-2000',
                        description: 'Austin area cybersecurity support'
                    }
                ]
            },

            'dallas_tx': {
                cityName: 'Dallas, TX',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Dallas County Emergency Management',
                        number: '(214) 819-6300',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Oncor Emergency Line',
                        number: '(888) 313-4747',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Dallas IT Emergency',
                        number: '(214) 670-4357',
                        description: 'Dallas area IT emergency support'
                    }
                ]
            },

            'houston_tx': {
                cityName: 'Houston, TX',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Harris County Emergency Management',
                        number: '(713) 881-3100',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'CenterPoint Energy Emergency',
                        number: '(713) 207-2222',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Houston Cyber Response',
                        number: '(713) 884-3131',
                        description: 'Houston area cybersecurity emergency support'
                    }
                ]
            },

            // Utah
            'salt_lake_city_ut': {
                cityName: 'Salt Lake City, UT',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Salt Lake County Emergency Management',
                        number: '(385) 468-6700',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Rocky Mountain Power Emergency',
                        number: '(888) 221-7070',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Salt Lake Cyber Services',
                        number: '(801) 799-3000',
                        description: 'Salt Lake area cybersecurity support'
                    }
                ]
            },

            // Washington
            'olympia_wa': {
                cityName: 'Olympia, WA',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'Thurston County Emergency Management',
                        number: '(360) 754-2933',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Puget Sound Energy Emergency',
                        number: '(888) 225-5773',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Olympia IT Services',
                        number: '(360) 753-8447',
                        description: 'Olympia area IT emergency support'
                    }
                ]
            },

            'seattle_wa': {
                cityName: 'Seattle, WA',
                contacts: [
                    {
                        type: 'Cyber Emergency',
                        name: 'FBI Cyber Division',
                        number: '(855) 292-3937',
                        description: 'Report cybercrimes and receive immediate assistance'
                    },
                    {
                        type: 'Government Cyber',
                        name: 'CISA',
                        number: '(888) 282-0870',
                        description: 'Cybersecurity and Infrastructure Security Agency hotline'
                    },
                    {
                        type: 'Emergency Services',
                        name: 'Fire Department',
                        number: '911',
                        description: 'For immediate life-threatening emergencies and active fire reports'
                    },
                    {
                        type: 'Evacuation Info',
                        name: 'King County Emergency Management',
                        number: '(206) 296-3830',
                        description: 'Non-emergency line for evacuation status and road closures'
                    },
                    {
                        type: 'Utilities Emergency',
                        name: 'Seattle City Light Emergency',
                        number: '(206) 684-3000',
                        description: 'Report power lines down or request emergency shutoffs'
                    },
                    {
                        type: 'Local IT Support',
                        name: 'Seattle IT Department',
                        number: '(206) 684-0464',
                        description: 'Seattle area cybersecurity support'
                    }
                ]
            }
        };

        // City coordinate to database key mapping
        const CITY_COORDINATES_TO_KEY = {
            '33.4484,-112.0740': 'phoenix_az',
            '34.0522,-118.2437': 'los_angeles_ca',
            '37.7749,-122.4194': 'san_francisco_ca',
            '38.5816,-121.4944': 'sacramento_ca',
            '39.7392,-104.9903': 'denver_co',
            '41.2033,-77.1945': 'pennsylvania',
            '43.6532,-116.3113': 'boise_id',
            '41.8781,-87.6298': 'chicago_il',
            '39.7817,-86.1478': 'indianapolis_in',
            '38.2904,-92.6390': 'missouri',
            '46.8772,-96.7898': 'fargo_nd',
            '36.1627,-86.7816': 'nashville_tn',
            '30.2672,-97.7431': 'austin_tx',
            '32.7767,-96.7970': 'dallas_tx',
            '29.7604,-95.3698': 'houston_tx',
            '40.7608,-111.8910': 'salt_lake_city_ut',
            '47.0379,-122.9015': 'olympia_wa',
            '47.6062,-122.3321': 'seattle_wa'
        };

        /**
         * Updates emergency contacts based on selected city
         */
        function updateEmergencyContacts(cityKey, containerId = 'emergency-contacts-grid') {
            const contacts = EMERGENCY_CONTACTS_DB[cityKey];
            const container = document.getElementById(containerId);
            
            if (!contacts || !container) {
                console.warn(`No contacts found for ${cityKey} or container ${containerId} not found`);
                return;
            }
            
            // Generate contacts grid HTML
            const contactsHTML = contacts.contacts.map(contact => `
                <div class="contact-card">
                    <div class="contact-type">${contact.type}</div>
                    <div class="contact-name">${contact.name}</div>
                    <div class="contact-number">${contact.number}</div>
                    <div class="contact-description">${contact.description}</div>
                </div>
            `).join('');
            
            container.innerHTML = contactsHTML;
            
            // Update page title if element exists
            const titleElement = document.getElementById('emergency-contacts-title');
            if (titleElement) {
                titleElement.textContent = `Critical Cybersecurity Contacts - ${contacts.cityName}`;
            }
            
            console.log(`Emergency contacts updated for ${contacts.cityName}`);
        }

        /**
         * Updates emergency contacts when city selector changes
         */
        function updateContactsFromCitySelector() {
            const citySelect = document.getElementById('city-select');
            if (!citySelect || !citySelect.value) return;
            
            const cityKey = CITY_COORDINATES_TO_KEY[citySelect.value];
            if (cityKey) {
                updateEmergencyContacts(cityKey);
            }
        }

        /**
         * Gets city key from coordinates (for auto-detected location)
         */
        function getCityKeyFromCoordinates(lat, lon) {
            // Find closest city from our database
            let closestCity = null;
            let minDistance = Infinity;
            
            Object.entries(CITY_COORDINATES_TO_KEY).forEach(([coords, key]) => {
                const [cityLat, cityLon] = coords.split(',').map(Number);
                const distance = Math.sqrt(
                    Math.pow(lat - cityLat, 2) + Math.pow(lon - cityLon, 2)
                );
                
                if (distance < minDistance) {
                    minDistance = distance;
                    closestCity = key;
                }
            });
            
            // Only return if within reasonable distance (about 2 degrees)
            return minDistance < 2 ? closestCity : 'denver_co'; // Default to Denver
        }

        /**
         * Auto-detect user location and update contacts
         */
        function autoDetectLocation() {
            if (!navigator.geolocation) {
                alert('Geolocation is not supported by this browser.');
                return;
            }

            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    
                    const cityKey = getCityKeyFromCoordinates(lat, lon);
                    if (cityKey) {
                        updateEmergencyContacts(cityKey);
                        
                        // Update the dropdown to reflect the detected location
                        const citySelect = document.getElementById('city-select');
                        const matchingOption = Array.from(citySelect.options).find(option => 
                            CITY_COORDINATES_TO_KEY[option.value] === cityKey
                        );
                        if (matchingOption) {
                            citySelect.value = matchingOption.value;
                        }
                        
                        console.log(`Location auto-detected: ${lat}, ${lon} -> ${cityKey}`);
                    } else {
                        alert('Could not find emergency contacts for your location. Please select your city manually.');
                    }
                },
                function(error) {
                    console.error('Geolocation error:', error);
                    alert('Could not detect your location. Please select your city manually.');
                }
            );
        }

        // ================================
        // INITIALIZATION
        // ================================

        /**
         * Initialize all threat monitoring when page loads
         */
        function initializeThreatMonitoring() {
            console.log('🛡️ Initializing cybersecurity threat monitoring...');
            
            // Start loading all threat intelligence feeds
            Promise.all([
                fetchCISAExploits(),
                fetchThreatFoxData(),
                fetchURLhausData()
            ]).then(() => {
                console.log('✅ All threat feeds loaded');
                updateThreatLevel();
                updateRiskAssessment();
                threatData.lastUpdate = new Date();
            }).catch(error => {
                console.error('❌ Error loading threat feeds:', error);
                // Even if APIs fail, we show mock data so the page is functional
                updateThreatLevel();
                updateRiskAssessment();
            });
            
            // Set up automatic refresh every 5 minutes
            setInterval(() => {
                console.log('🔄 Auto-refreshing threat intelligence...');
                fetchCISAExploits();
                fetchThreatFoxData();
                fetchURLhausData();
                updateThreatLevel();
                updateRiskAssessment();
            }, 5 * 60 * 1000);
        }

        // Start monitoring when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Cyberattack Emergency Page Loaded');
            initializeThreatMonitoring();
            
            // Set default location to Denver (user's location from preferences)
            updateEmergencyContacts('denver_co');
            
            // Update city selector to show Denver as selected
            const citySelect = document.getElementById('city-select');
            if (citySelect) {
                citySelect.value = '39.7392,-104.9903'; // Denver coordinates
            }
        });

        console.log('🛡️ Cybersecurity threat monitoring system loaded and ready');
    </script>
</body>
</html>
            