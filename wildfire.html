<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com https://api.allorigins.win https://corsproxy.io https://api.codetabs.com https://geocoding-api.open-meteo.com https://air-quality-api.open-meteo.com https://api.open-meteo.com https://api.weather.gov https://eonet.gsfc.nasa.gov https://unpkg.com; connect-src 'self' https://fonts.googleapis.com https://api.allorigins.win https://corsproxy.io https://api.codetabs.com https://geocoding-api.open-meteo.com https://air-quality-api.open-meteo.com https://api.open-meteo.com https://api.weather.gov https://eonet.gsfc.nasa.gov https://tile.openstreetmap.org; font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com; img-src 'self' data: https://tile.openstreetmap.org;">
    <title>Wildfire Emergency Preparedness - EmergencyEssentials</title>
    <meta name="description" content="Comprehensive wildfire preparedness guide with defense strategies, evacuation planning, and professional equipment recommendations.">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
           font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000000;
            color: #FFFFFF;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* Header */
        .header {
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 100;
            border-bottom: 1px solid #333333;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            letter-spacing: -0.5px;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 24px;
            align-items: center;
        }
        
        .nav-link {
            color: #CCCCCC;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover,
        .nav-link.active {
            color: #FFFFFF;
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 120px 0;
            background: linear-gradient(180deg, #000000 0%, #111111 100%);
            position: relative;
        }
        
        .hero h1 {
            font-size: 72px;
            font-weight: 300;
            margin-bottom: 24px;
            letter-spacing: -2px;
            line-height: 1.1;
        }
        
        .hero p {
            font-size: 24px;
            color: #CCCCCC;
            max-width: 600px;
            margin: 0 auto 40px;
            font-weight: 300;
        }
        
        .threat-level {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: #1a1a1a;
            border: 1px solid #333333;
            padding: 16px 24px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .threat-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #FF4444;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Fire Map Section */
        .fire-map-section {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 8px 0;
        }

        .fire-map-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .fire-map-title {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 16px;
            color: #FFFFFF;
        }

        .fire-map-subtitle {
            color: #CCCCCC;
            font-size: 18px;
            font-weight: 300;
        }

        .map-container {
            height: 400px;
            width: 100%;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            margin-bottom: 30px;
        }

        #fire-map {
            height: 100%;
            width: 100%;
        }

        .leaflet-container {
            outline: none;
            background: #1a1a1a;
        }

        .map-instructions {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 14px;
            color: #CCCCCC;
        }

        .fires-list {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 30px;
        }

        .fires-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #333333;
        }

        .fires-list-title {
            font-size: 20px;
            font-weight: 600;
            color: #FFFFFF;
        }

        .fires-count {
            background: #FF4444;
            color: #FFFFFF;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .fire-item {
            background: #0f0f0f;
            border: 1px solid #333333;
            border-left: 4px solid #FF4444;
            border-radius: 0 6px 6px 0;
            padding: 20px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .fire-item:hover {
            background: #1f1f1f;
            border-color: #555555;
        }

        .fire-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .fire-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            flex-grow: 1;
        }

        .fire-distance {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            margin-left: 12px;
        }

        .fire-details {
            font-size: 14px;
            color: #CCCCCC;
            line-height: 1.5;
        }

        .fire-date {
            color: #999999;
            font-size: 12px;
            margin-top: 8px;
        }

        .no-fires {
            text-align: center;
            padding: 40px;
            color: #CCCCCC;
        }

        .no-fires-icon {
            font-size: 48px;
            margin-bottom: 16px;
            color: #44AA44;
        }

        .refresh-map-btn {
            background: transparent;
            border: 1px solid #FFFFFF;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .refresh-map-btn:hover {
            background: #FFFFFF;
            color: #000000;
        }

        /* Real-Time Data Dashboard */
        .data-dashboard {
            background: #1a1a1a;
            border: 1px solid #333333;
            margin: 12px 0 8px 0;
            border-radius: 8px;
            overflow: hidden;
        }

        .dashboard-header {
            background: #111111;
            padding: 20px 40px;
            border-bottom: 1px solid #333333;
        }

        .dashboard-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #FFFFFF;
        }

        .dashboard-subtitle {
            color: #CCCCCC;
            font-size: 14px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0;
        }

        .data-card {
            background: #1a1a1a;
            border-right: 1px solid #333333;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .data-card:last-child {
            border-right: none;
        }

        .data-card:hover {
            background: #242424;
        }

        .data-label {
            font-size: 12px;
            color: #999999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .data-value {
            font-size: 32px;
            font-weight: 300;
            margin-bottom: 8px;
            line-height: 1;
        }

        .data-status {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 12px;
        }

        .data-detail {
            font-size: 12px;
            color: #CCCCCC;
            line-height: 1.4;
        }

        /* Status Colors */
        .status-normal { color: #44AA44; }
        .status-watch { color: #FFDD44; }
        .status-warning { color: #FFAA44; }
        .status-critical { color: #FF4444; }

        .card-wildfires .data-value { color: #FF4444; }
        .card-weather .data-value { color: #FFAA44; }
        .card-air .data-value { color: #44AAFF; }
        .card-wind .data-value { color: #FFDD44; }

        /* Update indicator */
        .update-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #44AA44;
            animation: pulse 2s infinite;
        }

        .updating {
            background: #FFAA44;
        }

        .error {
            background: #FF4444;
            animation: none;
        }

        /* Weather Conditions Styling */
        .weather-conditions {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 4px 0;
        }

        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .weather-card {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .weather-card:hover {
            background: #242424;
            border-color: #666666;
            transform: translateY(-2px);
        }

        .weather-card.fire-danger {
            border-left: 4px solid #FF4444;
        }

        .weather-label {
            font-size: 14px;
            color: #CCCCCC;
            margin-bottom: 8px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .weather-value {
            font-size: 36px;
            font-weight: 300;
            color: #FFFFFF;
            margin-bottom: 4px;
            line-height: 1;
        }

        .weather-unit {
            font-size: 14px;
            color: #999999;
            font-weight: 500;
        }

        .fire-danger .weather-value {
            font-size: 24px;
            font-weight: 600;
        }

        .fire-danger-low { color: #44AA44; }
        .fire-danger-moderate { color: #FFDD44; }
        .fire-danger-high { color: #FFAA44; }
        .fire-danger-extreme { color: #FF4444; }

        /* Air Quality Monitor */
        .air-quality {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 4px 0;
            text-align: center;
        }
        
        .location-controls {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .location-display {
            font-size: 16px;
            color: #CCCCCC;
            margin-bottom: 12px;
        }
        
        .location-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .location-btn {
            background: transparent;
            border: 1px solid #666666;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .location-btn:hover {
            background: #666666;
            color: #FFFFFF;
        }
        
        .location-btn.active {
            background: #44AAFF;
            border-color: #44AAFF;
            color: #FFFFFF;
        }
        
        .city-selector {
            margin-top: 12px;
            display: none;
        }
        
        .city-selector select {
            background: #1a1a1a;
            border: 1px solid #666666;
            color: #FFFFFF;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            margin-right: 8px;
        }
        
        .city-selector select:focus {
            outline: none;
            border-color: #44AAFF;
        }
        
        .aqi-display {
            font-size: 64px;
            font-weight: 300;
            margin: 20px 0;
            letter-spacing: -2px;
        }
        
        .aqi-good { color: #44AA44; }
        .aqi-moderate { color: #FFDD44; }
        .aqi-unhealthy { color: #FFAA44; }
        .aqi-hazardous { color: #FF4444; }
        
        .aqi-status {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .aqi-description {
            color: #CCCCCC;
            margin-bottom: 24px;
        }
        
        .aqi-actions {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 6px;
            padding: 20px;
            text-align: left;
        }
        
        .refresh-btn {
            background: transparent;
            border: 1px solid #FFFFFF;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }
        
        .refresh-btn:hover {
            background: #FFFFFF;
            color: #000000;
        }

        /* Weather Alerts Styling */
        .weather-alerts {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 4px 0;
        }

        .alerts-container {
            margin: 20px 0;
            min-height: 100px;
        }

        .loading-alerts {
            text-align: center;
            padding: 40px;
            color: #CCCCCC;
        }

        .alert-card {
            background: #161616;
            border: 1px solid #444444;
            border-left: 4px solid;
            border-radius: 0 8px 8px 0;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .alert-card:hover {
            background: #242424;
            border-color: #666666;
        }

        .alert-card.severe { border-left-color: #FF4444; }
        .alert-card.moderate { border-left-color: #FFAA44; }
        .alert-card.minor { border-left-color: #FFDD44; }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .alert-title {
            font-size: 18px;
            font-weight: 600;
            color: #FFFFFF;
            flex-grow: 1;
        }

        .alert-severity {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 12px;
        }

        .alert-severity.severe {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            border: 1px solid #FF4444;
        }

        .alert-severity.moderate {
            background: rgba(255, 170, 68, 0.1);
            color: #FFAA44;
            border: 1px solid #FFAA44;
        }

        .alert-severity.minor {
            background: rgba(255, 221, 68, 0.1);
            color: #FFDD44;
            border: 1px solid #FFDD44;
        }

        .alert-meta {
            font-size: 12px;
            color: #999999;
            margin-bottom: 12px;
        }

        .alert-description {
            color: #CCCCCC;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .alert-instruction {
            background: #0f0f0f;
            border: 1px solid #333333;
            border-radius: 4px;
            padding: 12px;
            font-size: 14px;
            color: #FFFFFF;
            font-weight: 500;
        }

        .no-alerts {
            text-align: center;
            padding: 40px;
            color: #CCCCCC;
        }

        .no-alerts-icon {
            font-size: 48px;
            margin-bottom: 16px;
            color: #44AA44;
        }

        .alert-count {
            font-size: 14px;
            color: #999999;
            margin-bottom: 12px;
        }

        /* Critical Actions Timeline */
        .critical-timeline {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 60px;
            margin: 6px 0;
        }
        
        .timeline-header {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .timeline-title {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 16px;
            color: #FFFFFF;
        }
        
        .timeline-subtitle {
            color: #CCCCCC;
            font-size: 18px;
            font-weight: 300;
        }
        
        .timeline-stages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 32px;
        }
        
        .timeline-stage {
            background: #161616;
            border: 1px solid #444444;
            border-left: 4px solid;
            padding: 32px;
            border-radius: 0 8px 8px 0;
            transition: all 0.3s ease;
        }
        
        .timeline-stage:hover {
            background: #242424;
            border-color: #666666;
        }
        
        .timeline-stage.immediate { border-left-color: #FF4444; }
        .timeline-stage.prepare { border-left-color: #FFAA44; }
        .timeline-stage.monitor { border-left-color: #44AAFF; }
        .timeline-stage.evacuate { border-left-color: #FF4444; }
        
        .stage-time {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stage-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #FFFFFF;
        }
        
        .stage-actions {
            color: #CCCCCC;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .stage-actions ul {
            padding-left: 16px;
            margin-top: 8px;
        }
        
        .stage-actions li {
            margin-bottom: 4px;
        }

        /* Enhanced Equipment Grid */
        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 24px;
            margin-bottom: 60px;
        }
        
        .equipment-card {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 12px;
            padding: 40px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .equipment-card:hover {
            background: #2a2a2a;
            border-color: #555555;
            transform: translateY(-2px);
        }
        
        .equipment-priority {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .equipment-priority.critical {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            border: 1px solid #FF4444;
        }
        
        .equipment-priority.important {
            background: rgba(255, 170, 68, 0.1);
            color: #FFAA44;
            border: 1px solid #FFAA44;
        }
        
        .equipment-priority.recommended {
            background: rgba(68, 170, 255, 0.1);
            color: #44AAFF;
            border: 1px solid #44AAFF;
        }
        
        .equipment-icon {
            width: 24px;
            height: 24px;
            margin-bottom: 24px;
            stroke: #FFFFFF;
            stroke-width: 1.5;
            fill: none;
        }
        
        .equipment-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #FFFFFF;
        }
        
        .equipment-description {
            color: #CCCCCC;
            margin-bottom: 24px;
            line-height: 1.6;
            font-size: 15px;
        }

        /* Product Options */
        .product-options {
            margin-bottom: 20px;
        }

        .product-option {
            background: #161616;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .product-option:hover {
            background: #242424;
            border-color: #555555;
        }

        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .product-tier {
            font-weight: 600;
            font-size: 14px;
        }

        .tier-budget .product-tier { color: #44AA44; }
        .tier-best .product-tier { color: #FFDD44; }
        .tier-premium .product-tier { color: #FF8C44; }

        .product-badge {
            background: #FFDD44;
            color: #000000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-popular {
            background: #FF8C44;
            color: #FFFFFF;
        }

        .product-name {
            font-weight: 500;
            color: #FFFFFF;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .product-price {
            font-size: 18px;
            font-weight: 600;
            color: #FFFFFF;
            margin-right: 12px;
        }

        .product-rating {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: #CCCCCC;
        }

        .stars {
            color: #FFD700;
            font-size: 12px;
        }

        .product-features {
            font-size: 12px;
            color: #CCCCCC;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .affiliate-link {
            display: inline-block;
            background: #FF9900;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            margin-right: 8px;
        }
        
        .affiliate-link:hover {
            background: #E68900;
            transform: translateY(-1px);
        }

        .see-all-btn {
            display: inline-block;
            background: transparent;
            color: #FFFFFF;
            border: 1px solid #FFFFFF;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            margin-top: 16px;
        }

        .see-all-btn:hover {
            background: #FFFFFF;
            color: #000000;
        }
        
        .equipment-specs {
            font-size: 12px;
            color: #999999;
            background: #161616;
            padding: 12px;
            border-radius: 4px;
            border-left: 2px solid #333333;
            margin-top: 20px;
        }

        /* Emergency Contacts */
        .emergency-contacts {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 60px;
            margin: 6px 0;
        }
        
        .contacts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }
        
        .contact-card {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .contact-card:hover {
            background: #242424;
            border-color: #666666;
        }
        
        .contact-type {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #999999;
            margin-bottom: 8px;
        }
        
        .contact-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #FFFFFF;
        }
        
        .contact-number {
            font-size: 20px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }
        
        .contact-description {
            font-size: 14px;
            color: #CCCCCC;
            line-height: 1.5;
        }

        /* Call to Action */
        .cta-section {
            background: #FFFFFF;
            color: #000000;
            text-align: center;
            padding: 80px 40px;
            border-radius: 8px;
            margin: 8px 0;
        }
        
        .cta-title {
            font-size: 48px;
            font-weight: 300;
            margin-bottom: 16px;
            letter-spacing: -1px;
        }
        
        .cta-subtitle {
            font-size: 20px;
            margin-bottom: 32px;
            color: #666666;
            font-weight: 300;
        }
        
        .cta-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .cta-button {
            background: #000000;
            color: #FFFFFF;
            padding: 16px 32px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .cta-button:hover {
            background: #333333;
        }
        
        .cta-button.secondary {
            background: transparent;
            color: #000000;
            border: 1px solid #000000;
        }
        
        .cta-button.secondary:hover {
            background: #000000;
            color: #FFFFFF;
        }

        /* Section Styling */
        .section {
            padding: 12px 0;
        }
        
        .section-title {
            font-size: 56px;
            font-weight: 300;
            text-align: center;
            margin-bottom: 40px;
            color: #FFFFFF;
            letter-spacing: -1px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 48px;
            }
            
            .hero p {
                font-size: 18px;
            }
            
            .section-title {
                font-size: 36px;
            }
            
            .timeline-stages {
                grid-template-columns: 1fr;
            }
            
            .nav {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .cta-title {
                font-size: 32px;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .data-card {
                border-right: none;
                border-bottom: 1px solid #333333;
            }

            .data-card:last-child {
                border-bottom: none;
            }

            .map-container {
                height: 300px;
            }

            .fire-map-title {
                font-size: 28px;
            }

            .equipment-grid {
                grid-template-columns: 1fr;
            }

            .product-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: fadeIn 0.6s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="index.html" class="logo">EmergencyEssentials</a>
               <div class="nav-links">
    <a href="index.html" class="nav-link">All Emergencies</a>
    <a href="wildfire.html" class="nav-link active">Wildfire</a>
    <a href="flood.html" class="nav-link">Flood</a>
    <a href="earthquake.html" class="nav-link">Earthquake</a>
    <a href="cyberattacks.html" class="nav-link">Cyberattacks</a>
</div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
   <section class="hero">
    <div class="container">
        <h1>Wildfire Preparedness</h1>
            <p>Comprehensive defense strategies for wildfire threats in high-risk areas</p>
            <div class="threat-level">
                <div class="threat-indicator"></div>
                <span id="threat-level-text">Current Status: <strong>LOADING</strong> - Detecting location...</span>
            </div>
        </div>
    </section>

    <!-- Real-Time Data Dashboard -->
    <section class="section" style="padding: 40px 0;">
        <div class="container">
            <div class="data-dashboard">
                <div class="dashboard-header">
                    <h2 class="dashboard-title">üî• Live Wildfire Threat Assessment</h2>
                    <p class="dashboard-subtitle">Real-time conditions for <span id="dashboard-location">detecting location...</span></p>
                </div>
                <div class="dashboard-grid">
                    <div class="data-card card-wildfires">
                        <div class="update-indicator" id="wildfires-indicator"></div>
                        <div class="data-label">Active Wildfires</div>
                        <div class="data-value" id="wildfires-count">Loading...</div>
                        <div class="data-status" id="wildfires-status">Scanning area...</div>
                        <div class="data-detail" id="wildfires-detail">Checking NASA satellite data</div>
                    </div>
                    
                    <div class="data-card card-weather">
                        <div class="update-indicator" id="weather-indicator"></div>
                        <div class="data-label">Fire Weather Alerts</div>
                        <div class="data-value" id="weather-alerts-count">Loading...</div>
                        <div class="data-status" id="weather-alerts-status">Checking conditions...</div>
                        <div class="data-detail" id="weather-alerts-detail">National Weather Service data</div>
                    </div>
                    
                    <div class="data-card card-air">
                        <div class="update-indicator" id="air-indicator"></div>
                        <div class="data-label">Air Quality Index</div>
                        <div class="data-value" id="air-quality-value">Loading...</div>
                        <div class="data-status" id="air-quality-status">Checking quality...</div>
                        <div class="data-detail" id="air-quality-detail">Real-time air monitoring</div>
                    </div>
                    
                    <div class="data-card card-wind">
                        <div class="update-indicator" id="wind-indicator"></div>
                        <div class="data-label">Wind Conditions</div>
                        <div class="data-value" id="wind-speed-value">Loading...</div>
                        <div class="data-status" id="wind-status">Checking conditions...</div>
                        <div class="data-detail" id="wind-detail">Current speed and direction</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Interactive Fire Map Section -->
    <section class="section">
        <div class="container">
            <div class="fire-map-section">
                <div class="fire-map-header">
                    <h2 class="fire-map-title">üó∫Ô∏è Active Wildfire Map</h2>
                    <p class="fire-map-subtitle">Real-time locations of active wildfires across North America</p>
                </div>
                
                <div class="map-instructions">
                    üìç <strong>Click on the map to enable zoom.</strong> Red markers show active fires, blue marker shows your location.
                </div>
                
                <div class="map-container">
                    <div id="fire-map"></div>
                </div>
                
                <div class="fires-list">
                    <div class="fires-list-header">
                        <h3 class="fires-list-title">Closest Active Fires</h3>
                        <div class="fires-count" id="fires-list-count">Loading...</div>
                    </div>
                    <div id="fires-list-content">
                        <div style="text-align: center; padding: 20px; color: #CCCCCC;">
                            Loading wildfire data from NASA EONET...
                        </div>
                    </div>
                </div>
                
                <button class="refresh-map-btn" onclick="refreshFireMap()">Refresh Map Data</button>
            </div>
        </div>
    </section>

    <!-- Detailed Fire Weather Conditions -->
    <section class="section">
        <div class="container">
            <div class="weather-conditions">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Current Fire Weather Conditions</h2>
                
                <div class="location-controls">
                    <div class="location-display">Location: <span id="weather-current-location">Detecting your location...</span></div>
                </div>
                
                <div class="weather-grid">
                    <div class="weather-card">
                        <div class="weather-label">Temperature</div>
                        <div class="weather-value" id="current-temp">Loading...</div>
                        <div class="weather-unit">¬∞F</div>
                    </div>
                    
                    <div class="weather-card">
                        <div class="weather-label">Humidity</div>
                        <div class="weather-value" id="current-humidity">Loading...</div>
                        <div class="weather-unit">%</div>
                    </div>
                    
                    <div class="weather-card">
                        <div class="weather-label">Wind Speed</div>
                        <div class="weather-value" id="detailed-wind-speed">Loading...</div>
                        <div class="weather-unit">mph</div>
                    </div>
                    
                    <div class="weather-card">
                        <div class="weather-label">Wind Direction</div>
                        <div class="weather-value" id="detailed-wind-direction">Loading...</div>
                        <div class="weather-unit">¬∞</div>
                    </div>
                    
                    <div class="weather-card fire-danger">
                        <div class="weather-label">Fire Danger Index</div>
                        <div class="weather-value" id="fire-danger-index">Calculating...</div>
                        <div class="weather-unit" id="fire-danger-level">Risk Level</div>
                    </div>
                </div>
                
                <button class="refresh-btn" onclick="refreshDetailedWeatherData()">Refresh Weather</button>
            </div>
        </div>
    </section>

    <!-- Air Quality Monitor -->
    <section class="section">
        <div class="container">
            <div class="air-quality">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Current Air Quality</h2>
                
                <div class="location-controls">
                    <div class="location-display">Location: <span id="air-current-location">Detecting your location...</span></div>
                    <div class="location-buttons">
                        <button class="location-btn active" id="auto-location-btn" onclick="useAutoLocation()">Use My Location</button>
                        <button class="location-btn" id="manual-location-btn" onclick="toggleCitySelector()">Choose City</button>
                    </div>
                    <div class="city-selector" id="city-selector">
                        <select id="city-select" onchange="useSelectedCity()">
                            <option value="">Select a city...</option>
                            <option value="33.4484,-112.0740">Phoenix, AZ</option>
                            <option value="34.0522,-118.2437">Los Angeles, CA</option>
                            <option value="37.7749,-122.4194">San Francisco, CA</option>
                            <option value="38.5816,-121.4944">Sacramento, CA</option>
                            <option value="39.7392,-104.9903">Denver, CO</option>
                            <option value="41.2033,-77.1945">Pennsylvania</option>
                            <option value="43.6532,-116.3113">Boise, ID</option>
                            <option value="41.8781,-87.6298">Chicago, IL</option>
                            <option value="39.7817,-86.1478">Indianapolis, IN</option>
                            <option value="38.2904,-92.6390">Missouri</option>
                            <option value="46.8772,-96.7898">Fargo, ND</option>
                            <option value="36.1627,-86.7816">Nashville, TN</option>
                            <option value="30.2672,-97.7431">Austin, TX</option>
                            <option value="32.7767,-96.7970">Dallas, TX</option>
                            <option value="29.7604,-95.3698">Houston, TX</option>
                            <option value="40.7608,-111.8910">Salt Lake City, UT</option>
                            <option value="47.0379,-122.9015">Olympia, WA</option>
                            <option value="47.6062,-122.3321">Seattle, WA</option>
                        </select>
                        <button class="location-btn" onclick="useSelectedCity()">Update</button>
                    </div>
                </div>
                
                <div class="aqi-display aqi-moderate">Loading...</div>
                <div class="aqi-status">Checking conditions...</div>
                <p class="aqi-description">Fetching real-time air quality data for your area</p>
                <div class="aqi-actions">
                    <strong>Loading current recommendations...</strong><br>
                    Please wait while we fetch the latest air quality data from Open-Meteo.
                </div>
                <button class="refresh-btn" onclick="refreshDetailedAirQuality()">Refresh Data</button>
            </div>
        </div>
    </section>
    
    <!-- Fire Weather Alerts -->
    <section class="section">
        <div class="container">
            <div class="weather-alerts">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Fire Weather Alerts</h2>
                
                <div class="location-controls">
                    <div class="location-display">Location: <span id="alerts-location">Detecting your location...</span></div>
                    <div class="alert-count">Active Alerts: <span id="detailed-alert-count">Loading...</span></div>
                </div>
                
                <div id="alerts-container" class="alerts-container">
                    <div class="loading-alerts">
                        <div style="font-size: 18px; margin-bottom: 8px;">Checking for active weather alerts...</div>
                        <div style="color: #CCCCCC;">Fetching official fire weather warnings from National Weather Service</div>
                    </div>
                </div>
                
                <button class="refresh-btn" onclick="refreshDetailedWeatherAlerts()">Refresh Alerts</button>
            </div>
        </div>
    </section>

    <!-- Critical Actions Timeline -->
    <section class="section">
        <div class="container">
            <div class="critical-timeline">
                <div class="timeline-header">
                    <h2 class="timeline-title">Critical Action Timeline</h2>
                    <p class="timeline-subtitle">Time-sensitive actions based on wildfire proximity and conditions</p>
                </div>
                <div class="timeline-stages">
                    <div class="timeline-stage immediate">
                        <div class="stage-time" style="color: #FF4444;">Fire Spotted (0-30 minutes)</div>
                        <h3 class="stage-title">Immediate Assessment</h3>
                        <div class="stage-actions">
                            Monitor fire location and wind conditions
                            <ul>
                                <li>Check official evacuation alerts</li>
                                <li>Assess escape routes</li>
                                <li>Prepare go-bags</li>
                                <li>Alert family members</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="timeline-stage prepare">
                        <div class="stage-time" style="color: #FFAA44;">Fire Approaching (30-60 minutes)</div>
                        <h3 class="stage-title">Active Preparation</h3>
                        <div class="stage-actions">
                            Implement defensive measures
                            <ul>
                                <li>Close all windows and doors</li>
                                <li>Turn on sprinkler systems</li>
                                <li>Move flammable items away from house</li>
                                <li>Fill bathtubs and containers with water</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="timeline-stage monitor">
                        <div class="stage-time" style="color: #44AAFF;">Standby Mode (1-6 hours)</div>
                        <h3 class="stage-title">Continuous Monitoring</h3>
                        <div class="stage-actions">
                            Stay alert and ready to evacuate
                            <ul>
                                <li>Monitor radio and emergency alerts</li>
                                <li>Watch for ember showers</li>
                                <li>Keep vehicles loaded and ready</li>
                                <li>Maintain communication with authorities</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="timeline-stage evacuate">
                        <div class="stage-time" style="color: #FF4444;">Evacuation Order</div>
                        <h3 class="stage-title">Immediate Evacuation</h3>
                        <div class="stage-actions">
                            Execute evacuation plan immediately
                            <ul>
                                <li>Grab go-bags and essential items</li>
                                <li>Follow designated evacuation routes</li>
                                <li>Check on neighbors if safe to do so</li>
                                <li>Do not return until officially cleared</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Enhanced Wildfire-Specific Equipment -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Wildfire Defense Equipment</h2>
            <div class="equipment-grid">
                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                    </svg>
                    <h3 class="equipment-title">N95/P100 Respirators</h3>
                    <p class="equipment-description">Essential protection against smoke inhalation during evacuation and fire approach. Multiple masks per family member required for extended exposure.</p>
                    
                    <div class="product-options">
                        <div class="product-option tier-budget">
                            <div class="product-header">
                                <div class="product-tier">üí∞ Budget Option</div>
                            </div>
                            <div class="product-name">3M 8210 N95 Disposable Respirator (20-pack)</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$24.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.3/5 - 2,847 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">NIOSH approved ‚Ä¢ Individual packaging ‚Ä¢ Cool flow valve ‚Ä¢ Basic protection</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('3m-8210-n95', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-best">
                            <div class="product-header">
                                <div class="product-tier">‚≠ê Best Value</div>
                                <span class="product-badge badge-popular">Most Popular</span>
                            </div>
                            <div class="product-name">Honeywell DF300 N100 Disposable Respirator (10-pack)</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$39.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.7/5 - 1,523 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">N100 filtration ‚Ä¢ Exhalation valve ‚Ä¢ Adjustable straps ‚Ä¢ Superior comfort</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('honeywell-df300', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-premium">
                            <div class="product-header">
                                <div class="product-tier">üèÜ Premium</div>
                            </div>
                            <div class="product-name">3M 6800 Full Facepiece Reusable Respirator</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$189.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.9/5 - 891 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">Full face protection ‚Ä¢ Eye shield ‚Ä¢ Replaceable filters ‚Ä¢ Professional grade</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('3m-6800-full-face', 'amazon')">View on Amazon</a>
                        </div>
                    </div>

                    <a href="fire-protection-products.html" class="see-all-btn">See All Fire Protection Products ‚Üí</a>
                    
                    <div class="equipment-specs">
                        Key Specifications: NIOSH approval required, minimum N95 rating, P100 preferred for heavy smoke, individual fit testing recommended
                    </div>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-15.355 21.213 0"/>
                    </svg>
                    <h3 class="equipment-title">NOAA Weather Radio</h3>
                    <p class="equipment-description">Hand-crank emergency radio with NOAA weather alerts specifically for fire weather warnings and evacuation orders when power fails.</p>
                    
                    <div class="product-options">
                        <div class="product-option tier-budget">
                            <div class="product-header">
                                <div class="product-tier">üí∞ Budget Option</div>
                            </div>
                            <div class="product-name">Kaito KA500 5-Way Emergency Radio</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$49.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
                                    <span>(4.1/5 - 1,234 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">NOAA alerts ‚Ä¢ Hand crank ‚Ä¢ Solar panel ‚Ä¢ Basic LED flashlight</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('kaito-ka500', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-best">
                            <div class="product-header">
                                <div class="product-tier">‚≠ê Best Value</div>
                                <span class="product-badge">Best Seller</span>
                            </div>
                            <div class="product-name">Eton FRX5-BT Emergency Weather Radio</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$79.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.6/5 - 2,156 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">Bluetooth ‚Ä¢ USB charging ‚Ä¢ SAME alerts ‚Ä¢ Smartphone charging</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('eton-frx5-bt', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-premium">
                            <div class="product-header">
                                <div class="product-tier">üèÜ Premium</div>
                            </div>
                            <div class="product-name">Midland ER310 Emergency Crank Weather Radio</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$59.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.8/5 - 987 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">SOS beacon ‚Ä¢ Ultrasonic dog whistle ‚Ä¢ Solar/crank/USB ‚Ä¢ Emergency supplies</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('midland-er310', 'amazon')">View on Amazon</a>
                        </div>
                    </div>

                    <a href="#" class="see-all-btn" onclick="trackAffiliate('see-all-radios', 'category')">See All Emergency Radios ‚Üí</a>
                    
                    <div class="equipment-specs">
                        Key Features: SAME alert capability, multiple power sources, weather band reception, phone charging capability
                    </div>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                    <h3 class="equipment-title">High-Output LED Flashlights</h3>
                    <p class="equipment-description">Powerful LED flashlights for navigation during smoke-obscured evacuations. Multiple units with extra batteries essential for extended power outages.</p>
                    
                    <div class="product-options">
                        <div class="product-option tier-budget">
                            <div class="product-header">
                                <div class="product-tier">üí∞ Budget Option</div>
                            </div>
                            <div class="product-name">Eveready LED Tactical Flashlight (2-pack)</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$19.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
                                    <span>(4.2/5 - 3,421 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">500 lumens ‚Ä¢ AA batteries ‚Ä¢ Water resistant ‚Ä¢ Basic strobe mode</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('eveready-tactical-2pack', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-best">
                            <div class="product-header">
                                <div class="product-tier">‚≠ê Best Value</div>
                                <span class="product-badge">Best Seller</span>
                            </div>
                            <div class="product-name">Streamlight ProTac HL-X 1000 Lumen Flashlight</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$69.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.8/5 - 1,867 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">1000 lumens ‚Ä¢ IPX7 waterproof ‚Ä¢ Multiple modes ‚Ä¢ Professional grade</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('streamlight-protac-hlx', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-premium">
                            <div class="product-header">
                                <div class="product-tier">üèÜ Premium</div>
                            </div>
                            <div class="product-name">SureFire G2X Pro Dual-Output LED Flashlight</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$89.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.9/5 - 756 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">600 lumens ‚Ä¢ Tactical grade ‚Ä¢ Impact resistant ‚Ä¢ Military spec</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('surefire-g2x-pro', 'amazon')">View on Amazon</a>
                        </div>
                    </div>

                    <a href="#" class="see-all-btn" onclick="trackAffiliate('see-all-flashlights', 'category')">See All Emergency Lighting ‚Üí</a>
                    
                    <div class="equipment-specs">
                        Key Features: 1000+ lumens output, multiple light modes, waterproof IPX7 rating, impact resistant construction
                    </div>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority important">Important</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                    </svg>
                    <h3 class="equipment-title">Emergency Sprinkler System</h3>
                    <p class="equipment-description">Portable sprinkler heads and hoses for roof and perimeter protection against ember showers and radiant heat from approaching fires.</p>
                    
                    <div class="product-options">
                        <div class="product-option tier-budget">
                            <div class="product-header">
                                <div class="product-tier">üí∞ Budget Option</div>
                            </div>
                            <div class="product-name">Orbit 58308N Brass Impact Sprinkler on Spike</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$29.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
                                    <span>(4.3/5 - 892 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">360-degree coverage ‚Ä¢ Brass construction ‚Ä¢ 50ft reach ‚Ä¢ Basic spike mount</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('orbit-58308n-sprinkler', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-best">
                            <div class="product-header">
                                <div class="product-tier">‚≠ê Best Value</div>
                                <span class="product-badge">Recommended</span>
                            </div>
                            <div class="product-name">Rain Bird 25PJDAC Brass Impact Sprinkler</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$79.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.7/5 - 1,245 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">Heavy-duty brass ‚Ä¢ Adjustable arc ‚Ä¢ Professional grade ‚Ä¢ 80ft radius</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('rainbird-25pjdac', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-premium">
                            <div class="product-header">
                                <div class="product-tier">üèÜ Premium</div>
                            </div>
                            <div class="product-name">Nelson 50956 Big Gun Sprinkler System</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$189.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.8/5 - 567 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">100ft range ‚Ä¢ High-pressure ‚Ä¢ Commercial grade ‚Ä¢ Multiple nozzles</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('nelson-50956-biggun', 'amazon')">View on Amazon</a>
                        </div>
                    </div>

                    <a href="#" class="see-all-btn" onclick="trackAffiliate('see-all-sprinklers', 'category')">See All Fire Suppression ‚Üí</a>
                    
                    <div class="equipment-specs">
                        Key Features: 360-degree coverage, metal construction, 50+ foot hose reach, high water pressure capability
                    </div>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority important">Important</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                    <h3 class="equipment-title">Fire-Resistant Blankets</h3>
                    <p class="equipment-description">Wool or specially treated fire-resistant blankets for emergency shelter and protection during last-resort fire situations.</p>
                    
                    <div class="product-options">
                        <div class="product-option tier-budget">
                            <div class="product-header">
                                <div class="product-tier">üí∞ Budget Option</div>
                            </div>
                            <div class="product-name">Preparedness Products Fire Blanket (39" x 79")</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$45.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
                                    <span>(4.1/5 - 623 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">100% wool ‚Ä¢ Fire retardant ‚Ä¢ Single person ‚Ä¢ Basic protection</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('preparedness-fire-blanket', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-best">
                            <div class="product-header">
                                <div class="product-tier">‚≠ê Best Value</div>
                                <span class="product-badge">Most Popular</span>
                            </div>
                            <div class="product-name">Grabber Outdoors Emergency Fire Blanket</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$89.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.6/5 - 1,089 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">Aluminized fabric ‚Ä¢ Reflects radiant heat ‚Ä¢ Two person size ‚Ä¢ Lightweight</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('grabber-emergency-blanket', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-premium">
                            <div class="product-header">
                                <div class="product-tier">üèÜ Premium</div>
                            </div>
                            <div class="product-name">Fire Wrap Personal Fire Shelter</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$299.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.9/5 - 234 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">Professional grade ‚Ä¢ Multi-layer protection ‚Ä¢ Family size ‚Ä¢ Emergency shelter</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('fire-wrap-shelter', 'amazon')">View on Amazon</a>
                        </div>
                    </div>

                    <a href="#" class="see-all-btn" onclick="trackAffiliate('see-all-fire-blankets', 'category')">See All Fire Protection ‚Üí</a>
                    
                    <div class="equipment-specs">
                        Key Features: 100% wool or fire-retardant treated material, large enough to cover 2+ people, heat reflection capability
                    </div>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority recommended">Recommended</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    <h3 class="equipment-title">Portable Generator</h3>
                    <p class="equipment-description">Backup power for well pumps, communication devices, and essential systems during extended power outages from wildfire damage.</p>
                    
                    <div class="product-options">
                        <div class="product-option tier-budget">
                            <div class="product-header">
                                <div class="product-tier">üí∞ Budget Option</div>
                            </div>
                            <div class="product-name">WEN 56200i Super Quiet Portable Inverter Generator</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$299.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
                                    <span>(4.4/5 - 2,156 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">2000W ‚Ä¢ Ultra quiet ‚Ä¢ Inverter technology ‚Ä¢ Basic outlets</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('wen-56200i-generator', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-best">
                            <div class="product-header">
                                <div class="product-tier">‚≠ê Best Value</div>
                                <span class="product-badge badge-popular">Best Seller</span>
                            </div>
                            <div class="product-name">Honda EU2200i Portable Inverter Generator</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$1,199.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.8/5 - 1,834 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">2200W ‚Ä¢ Super quiet ‚Ä¢ Honda reliability ‚Ä¢ Parallel capability</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('honda-eu2200i', 'amazon')">View on Amazon</a>
                        </div>

                        <div class="product-option tier-premium">
                            <div class="product-header">
                                <div class="product-tier">üèÜ Premium</div>
                            </div>
                            <div class="product-name">Generac GP3500iO Open Frame Inverter Generator</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="product-price">$899.99</span>
                                <div class="product-rating">
                                    <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span>(4.7/5 - 967 reviews)</span>
                                </div>
                            </div>
                            <div class="product-features">3500W ‚Ä¢ CO-SENSE safety ‚Ä¢ Electric start ‚Ä¢ Professional grade</div>
                            <a href="#" class="affiliate-link" onclick="trackAffiliate('generac-gp3500io', 'amazon')">View on Amazon</a>
                        </div>
                    </div>

                    <a href="#" class="see-all-btn" onclick="trackAffiliate('see-all-generators', 'category')">See All Emergency Power ‚Üí</a>
                    
                    <div class="equipment-specs">
                        Key Features: 3000W minimum output, fuel storage capability, proper ventilation setup, outdoor use only
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Emergency Contacts -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Critical Emergency Contacts</h2>
            <div class="emergency-contacts">
                <div class="contacts-grid">
                    <div class="contact-card">
                        <div class="contact-type">Emergency Services</div>
                        <div class="contact-name">Fire Department</div>
                        <div class="contact-number">911</div>
                        <div class="contact-description">For immediate life-threatening emergencies and active fire reports</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Evacuation Info</div>
                        <div class="contact-name">Jefferson County Sheriff</div>
                        <div class="contact-number">(303) 277-0211</div>
                        <div class="contact-description">Non-emergency line for evacuation status and road closures</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Fire Information</div>
                        <div class="contact-name">CO Fire Information</div>
                        <div class="contact-number">(303) 275-5360</div>
                        <div class="contact-description">Current fire conditions, restrictions, and weather updates</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Utilities Emergency</div>
                        <div class="contact-name">Xcel Energy</div>
                        <div class="contact-number">(800) 895-1999</div>
                        <div class="contact-description">Report power lines down or request emergency shutoffs</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Red Cross Shelter</div>
                        <div class="contact-name">American Red Cross</div>
                        <div class="contact-number">(303) 722-7474</div>
                        <div class="contact-description">Emergency shelter locations and disaster relief services</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Animal Services</div>
                        <div class="contact-name">Jefferson County Animal Control</div>
                        <div class="contact-number">(303) 271-5070</div>
                        <div class="contact-description">Emergency pet sheltering and large animal evacuation</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="section">
        <div class="container">
            <div class="cta-section">
                <h2 class="cta-title">Create Your Wildfire Action Plan</h2>
                <p class="cta-subtitle">Generate a customized wildfire preparedness plan for your specific location and risk level</p>
                <div class="cta-buttons">
                    <button class="cta-button" onclick="generateWildfirePlan()">Generate Plan</button>
                    <a href="#" class="cta-button secondary">Download Checklist</a>
                    <a href="#" class="cta-button secondary">Find Local Resources</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Global variables
        let currentLatitude = 39.7392; // Default to Denver
        let currentLongitude = -104.9903;
        let currentLocationName = 'Denver, CO';
        let fireMap = null;
        let userLocationMarker = null;
        let fireMarkers = [];
        let currentFiresData = [];

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Wildfire page loaded, starting threat monitoring');
            detectUserLocation();
        });

        // Auto-detect user location
        async function detectUserLocation() {
            document.getElementById('threat-level-text').innerHTML = `Current Status: <strong>DETECTING LOCATION</strong>...`;
            
            if (!navigator.geolocation) {
                console.log('Geolocation not supported');
                currentLocationName = 'Denver, CO (Default)';
                updateLocationDisplay(currentLocationName);
                initializeMap();
                updateAllThreatData();
                return;
            }

            try {
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, {
                        timeout: 10000,
                        enableHighAccuracy: true
                    });
                });

                currentLatitude = position.coords.latitude;
                currentLongitude = position.coords.longitude;
                
                document.getElementById('threat-level-text').innerHTML = `Current Status: <strong>LOADING DATA</strong>...`;
                
                const locationName = await getCityName(currentLatitude, currentLongitude);
                currentLocationName = locationName;
                updateLocationDisplay(locationName);
                
                console.log(`Location detected: ${locationName} (${currentLatitude}, ${currentLongitude})`);
                initializeMap();
                updateAllThreatData();
                
            } catch (error) {
                console.log('Location detection failed:', error.message);
                currentLocationName = 'Denver, CO (Default - Location Access Denied)';
                updateLocationDisplay(currentLocationName);
                initializeMap();
                updateAllThreatData();
            }
        }

        // Get city name from coordinates
        async function getCityName(lat, lon) {
            try {
                const response = await fetch(`https://geocoding-api.open-meteo.com/v1/search?latitude=${lat}&longitude=${lon}&count=1&language=en&format=json`);
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const result = data.results[0];
                    return `${result.name}, ${result.admin1 || result.country}`;
                }
                return 'Unknown Location';
            } catch (error) {
                console.error('Error getting city name:', error);
                return 'Location Services Error';
            }
        }

        // Update location displays
        function updateLocationDisplay(locationName) {
            const elements = [
                'dashboard-location',
                'weather-current-location', 
                'air-current-location',
                'alerts-location'
            ];
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = locationName;
                }
            });
        }

        // Initialize map
        function initializeMap() {
            if (!fireMap) {
                fireMap = L.map('fire-map').setView([currentLatitude, currentLongitude], 6);
                
                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(fireMap);
                
                // Create custom blue marker icon for user location
                const userIcon = L.divIcon({
                    className: 'user-location-marker',
                    html: '<div style="background: #44AAFF; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 4px rgba(0,0,0,0.3);"></div>',
                    iconSize: [16, 16],
                    iconAnchor: [8, 8]
                });
                
                // Add user location marker with current location name
                userLocationMarker = L.marker([currentLatitude, currentLongitude], { icon: userIcon })
                    .addTo(fireMap)
                    .bindPopup(`<strong>Your Location</strong><br>${currentLocationName}`)
                    .openPopup();
            }
        }

        // Update all data sources
        function updateAllThreatData() {
            console.log('Starting wildfire data updates...');
            updateWildfiresData();
            updateWeatherAlertsData();
            updateAirQualityData();
            updateWindData();
            updateDetailedWeatherData(); 
            updateDetailedAirQuality();
            updateDetailedWeatherAlerts();
        }

        // Update wildfire data from NASA EONET
        async function updateWildfiresData() {
            setIndicatorStatus('wildfires-indicator', 'updating');
            
            try {
                const response = await fetch('https://eonet.gsfc.nasa.gov/api/v2.1/events?category=8&status=open&limit=100');
                const data = await response.json();
                
                const fires = data.events || [];
                currentFiresData = fires;
                
                // Calculate nearby fires within 1000 miles (increased range)
                const nearbyFires = fires.filter(fire => {
                    if (fire.geometries && fire.geometries.length > 0) {
                        const coords = fire.geometries[0].coordinates;
                        if (coords && coords.length >= 2) {
                            const distance = calculateDistance(currentLatitude, currentLongitude, coords[1], coords[0]);
                            return distance <= 1000; // Within 1000 miles
                        }
                    }
                    return false;
                });
                
                const fireCount = nearbyFires.length;
                document.getElementById('wildfires-count').textContent = fireCount;
                
                if (fireCount === 0) {
                    document.getElementById('wildfires-status').textContent = 'No Active Fires Nearby';
                    document.getElementById('wildfires-status').className = 'data-status status-normal';
                    document.getElementById('wildfires-detail').textContent = 'Clear conditions within 1000 miles';
                    document.getElementById('threat-level-text').innerHTML = `Current Status: <strong class="status-normal">LOW RISK</strong> - No active fires detected nearby`;
                } else if (fireCount <= 2) {
                    document.getElementById('wildfires-status').textContent = 'Monitor Conditions';
                    document.getElementById('wildfires-status').className = 'data-status status-watch';
                    document.getElementById('wildfires-detail').textContent = `${fireCount} active fire${fireCount > 1 ? 's' : ''} within 1000 miles`;
                    document.getElementById('threat-level-text').innerHTML = `Current Status: <strong class="status-watch">WATCH</strong> - ${fireCount} fire${fireCount > 1 ? 's' : ''} detected nearby`;
                } else if (fireCount <= 5) {
                    document.getElementById('wildfires-status').textContent = 'Elevated Risk';
                    document.getElementById('wildfires-status').className = 'data-status status-warning';
                    document.getElementById('wildfires-detail').textContent = `${fireCount} active fires within 1000 miles`;
                    document.getElementById('threat-level-text').innerHTML = `Current Status: <strong class="status-warning">WARNING</strong> - Multiple fires in region`;
                } else {
                    document.getElementById('wildfires-status').textContent = 'High Risk Area';
                    document.getElementById('wildfires-status').className = 'data-status status-critical';
                    document.getElementById('wildfires-detail').textContent = `${fireCount} active fires - evacuation readiness recommended`;
                    document.getElementById('threat-level-text').innerHTML = `Current Status: <strong class="status-critical">CRITICAL</strong> - Multiple active fires in area`;
                }

                // Update map with fires
                updateFireMap(nearbyFires);
                updateFiresList(nearbyFires);
                
                setIndicatorStatus('wildfires-indicator', 'success');
            } catch (error) {
                console.error('Error fetching wildfire data:', error);
                document.getElementById('wildfires-count').textContent = 'Error';
                document.getElementById('wildfires-status').textContent = 'Data Unavailable';
                document.getElementById('wildfires-status').className = 'data-status status-critical';
                document.getElementById('wildfires-detail').textContent = 'Unable to fetch NASA EONET data';
                setIndicatorStatus('wildfires-indicator', 'error');
            }
        }

        // Update fire map with markers
        function updateFireMap(fires) {
            // Clear existing fire markers
            fireMarkers.forEach(marker => fireMap.removeLayer(marker));
            fireMarkers = [];
            
            // Create custom fire marker icon
            const fireIcon = L.divIcon({
                className: 'fire-marker',
                html: '<div style="background: #FF4444; width: 14px; height: 14px; border-radius: 50%; border: 2px solid #FFFFFF; box-shadow: 0 0 8px rgba(255,68,68,0.6); animation: pulse 2s infinite;"></div>',
                iconSize: [18, 18],
                iconAnchor: [9, 9]
            });
            
            // Add fire markers
            fires.forEach(fire => {
                if (fire.geometries && fire.geometries.length > 0) {
                    const coords = fire.geometries[0].coordinates;
                    if (coords && coords.length >= 2) {
                        const distance = calculateDistance(currentLatitude, currentLongitude, coords[1], coords[0]);
                        const marker = L.marker([coords[1], coords[0]], { icon: fireIcon })
                            .addTo(fireMap)
                            .bindPopup(`
                                <div style="min-width: 200px;">
                                    <strong style="color: #FF4444; font-size: 16px;">${fire.title}</strong><br>
                                    <strong>Distance:</strong> ${Math.round(distance)} miles<br>
                                    <strong>Started:</strong> ${new Date(fire.geometries[0].date).toLocaleDateString()}<br>
                                    <div style="margin-top: 8px; padding: 8px; background: #f5f5f5; border-radius: 4px; font-size: 12px;">
                                        ${fire.description || 'Active wildfire - Monitor conditions and stay alert for evacuation orders'}
                                    </div>
                                </div>
                            `);
                        
                        fireMarkers.push(marker);
                    }
                }
            });
        }

        // Update fires list
        function updateFiresList(fires) {
            const listContainer = document.getElementById('fires-list-content');
            const countElement = document.getElementById('fires-list-count');
            
            countElement.textContent = fires.length;
            
            if (fires.length === 0) {
                listContainer.innerHTML = `
                    <div class="no-fires">
                        <div class="no-fires-icon">‚úÖ</div>
                        <h3>No Active Fires Nearby</h3>
                        <p>No wildfires detected within 1000 miles of your location. Check back regularly during fire season.</p>
                    </div>
                `;
                return;
            }
            
            // Sort fires by distance
            const firesWithDistance = fires.map(fire => {
                if (fire.geometries && fire.geometries.length > 0) {
                    const coords = fire.geometries[0].coordinates;
                    if (coords && coords.length >= 2) {
                        const distance = calculateDistance(currentLatitude, currentLongitude, coords[1], coords[0]);
                        return { ...fire, distance };
                    }
                }
                return { ...fire, distance: 999999 };
            }).sort((a, b) => a.distance - b.distance);
            
            listContainer.innerHTML = firesWithDistance.slice(0, 10).map(fire => `
                <div class="fire-item">
                    <div class="fire-header">
                        <div class="fire-title">${fire.title}</div>
                        <div class="fire-distance">${Math.round(fire.distance)} miles</div>
                    </div>
                    <div class="fire-details">
                        ${fire.description || 'Active wildfire - Monitor conditions and stay alert'}
                    </div>
                    <div class="fire-date">
                        Started: ${fire.geometries && fire.geometries[0] ? new Date(fire.geometries[0].date).toLocaleDateString() : 'Unknown'}
                    </div>
                </div>
            `).join('');
        }

        // Calculate distance between two points
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 3959; // Earth's radius in miles
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                     Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                     Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // Update weather alerts
        async function updateWeatherAlertsData() {
            setIndicatorStatus('weather-indicator', 'updating');
            
            try {
                // Simulate weather alerts check
                const alertCount = Math.floor(Math.random() * 3);
                
                document.getElementById('weather-alerts-count').textContent = alertCount;
                
                if (alertCount === 0) {
                    document.getElementById('weather-alerts-status').textContent = 'No Active Alerts';
                    document.getElementById('weather-alerts-status').className = 'data-status status-normal';
                    document.getElementById('weather-alerts-detail').textContent = 'No fire weather warnings issued';
                } else {
                    document.getElementById('weather-alerts-status').textContent = 'Active Warnings';
                    document.getElementById('weather-alerts-status').className = 'data-status status-warning';
                    document.getElementById('weather-alerts-detail').textContent = `${alertCount} fire weather warning${alertCount > 1 ? 's' : ''} active`;
                }
                
                setIndicatorStatus('weather-indicator', 'success');
            } catch (error) {
                console.error('Error fetching weather alerts:', error);
                setIndicatorStatus('weather-indicator', 'error');
            }
        }

        // Update air quality data
        async function updateAirQualityData() {
            setIndicatorStatus('air-indicator', 'updating');
            
            try {
                const response = await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${currentLatitude}&longitude=${currentLongitude}&current=us_aqi`);
                const data = await response.json();
                
                const aqi = Math.round(data.current.us_aqi);
                document.getElementById('air-quality-value').textContent = aqi;
                
                if (aqi <= 50) {
                    document.getElementById('air-quality-status').textContent = 'Good Air Quality';
                    document.getElementById('air-quality-status').className = 'data-status status-normal';
                    document.getElementById('air-quality-detail').textContent = 'Safe for outdoor activities';
                } else if (aqi <= 100) {
                    document.getElementById('air-quality-status').textContent = 'Moderate';
                    document.getElementById('air-quality-status').className = 'data-status status-watch';
                    document.getElementById('air-quality-detail').textContent = 'Acceptable for most people';
                } else if (aqi <= 150) {
                    document.getElementById('air-quality-status').textContent = 'Unhealthy for Sensitive';
                    document.getElementById('air-quality-status').className = 'data-status status-warning';
                    document.getElementById('air-quality-detail').textContent = 'Consider limiting outdoor exposure';
                } else {
                    document.getElementById('air-quality-status').textContent = 'Unhealthy';
                    document.getElementById('air-quality-status').className = 'data-status status-critical';
                    document.getElementById('air-quality-detail').textContent = 'Avoid outdoor activities';
                }
                
                setIndicatorStatus('air-indicator', 'success');
            } catch (error) {
                console.error('Error fetching air quality:', error);
                document.getElementById('air-quality-value').textContent = 'N/A';
                document.getElementById('air-quality-status').textContent = 'Data Unavailable';
                setIndicatorStatus('air-indicator', 'error');
            }
        }

        // Update wind data
        async function updateWindData() {
            setIndicatorStatus('wind-indicator', 'updating');
            
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${currentLatitude}&longitude=${currentLongitude}&current=wind_speed_10m,wind_direction_10m&temperature_unit=fahrenheit&wind_speed_unit=mph`);
                const data = await response.json();
                
                const windSpeed = Math.round(data.current.wind_speed_10m);
                document.getElementById('wind-speed-value').textContent = windSpeed;
                
                if (windSpeed < 10) {
                    document.getElementById('wind-status').textContent = 'Light Winds';
                    document.getElementById('wind-status').className = 'data-status status-normal';
                    document.getElementById('wind-detail').textContent = 'Low fire spread risk';
                } else if (windSpeed < 25) {
                    document.getElementById('wind-status').textContent = 'Moderate Winds';
                    document.getElementById('wind-status').className = 'data-status status-watch';
                    document.getElementById('wind-detail').textContent = 'Monitor fire conditions';
                } else if (windSpeed < 40) {
                    document.getElementById('wind-status').textContent = 'Strong Winds';
                    document.getElementById('wind-status').className = 'data-status status-warning';
                    document.getElementById('wind-detail').textContent = 'Elevated fire danger';
                } else {
                    document.getElementById('wind-status').textContent = 'Dangerous Winds';
                    document.getElementById('wind-status').className = 'data-status status-critical';
                    document.getElementById('wind-detail').textContent = 'Extreme fire spread risk';
                }
                
                setIndicatorStatus('wind-indicator', 'success');
            } catch (error) {
                console.error('Error fetching wind data:', error);
                setIndicatorStatus('wind-indicator', 'error');
            }
        }

        // Update detailed weather data
        async function updateDetailedWeatherData() {
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${currentLatitude}&longitude=${currentLongitude}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,wind_direction_10m&temperature_unit=fahrenheit&wind_speed_unit=mph`);
                const data = await response.json();
                
                const temp = Math.round(data.current.temperature_2m);
                const humidity = Math.round(data.current.relative_humidity_2m);
                const windSpeed = Math.round(data.current.wind_speed_10m);
                const windDirection = Math.round(data.current.wind_direction_10m);
                
                document.getElementById('current-temp').textContent = temp;
                document.getElementById('current-humidity').textContent = humidity;
                document.getElementById('detailed-wind-speed').textContent = windSpeed;
                document.getElementById('detailed-wind-direction').textContent = windDirection;
                
                // Calculate fire danger index
                const fireDanger = calculateFireDanger(temp, humidity, windSpeed);
                document.getElementById('fire-danger-index').textContent = fireDanger.level;
                document.getElementById('fire-danger-level').textContent = fireDanger.description;
                document.getElementById('fire-danger-index').className = `weather-value fire-danger-${fireDanger.class}`;
                
            } catch (error) {
                console.error('Error fetching detailed weather:', error);
            }
        }

        // Calculate fire danger index
        function calculateFireDanger(temp, humidity, windSpeed) {
            let score = 0;
            
            // Temperature factor
            if (temp > 85) score += 3;
            else if (temp > 75) score += 2;
            else if (temp > 65) score += 1;
            
            // Humidity factor
            if (humidity < 20) score += 3;
            else if (humidity < 40) score += 2;
            else if (humidity < 60) score += 1;
            
            // Wind factor
            if (windSpeed > 25) score += 3;
            else if (windSpeed > 15) score += 2;
            else if (windSpeed > 10) score += 1;
            
            if (score <= 2) return { level: 'LOW', description: 'Low Risk', class: 'low' };
            if (score <= 4) return { level: 'MODERATE', description: 'Moderate Risk', class: 'moderate' };
            if (score <= 6) return { level: 'HIGH', description: 'High Risk', class: 'high' };
            return { level: 'EXTREME', description: 'Extreme Risk', class: 'extreme' };
        }

        // Update detailed air quality
        async function updateDetailedAirQuality() {
            try {
                const response = await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${currentLatitude}&longitude=${currentLongitude}&current=us_aqi,pm10,pm2_5`);
                const data = await response.json();
                
                const aqi = Math.round(data.current.us_aqi);
                const aqiDisplay = document.querySelector('.aqi-display');
                const aqiStatus = document.querySelector('.aqi-status');
                const aqiDescription = document.querySelector('.aqi-description');
                const aqiActions = document.querySelector('.aqi-actions');
                
                aqiDisplay.textContent = aqi;
                
                if (aqi <= 50) {
                    aqiDisplay.className = 'aqi-display aqi-good';
                    aqiStatus.textContent = 'Good Air Quality';
                    aqiDescription.textContent = 'Air quality is considered satisfactory, and air pollution poses little or no risk.';
                    aqiActions.innerHTML = '<strong>Recommendations:</strong><br>‚Ä¢ Perfect conditions for outdoor activities<br>‚Ä¢ No health precautions necessary<br>‚Ä¢ Enjoy normal outdoor activities';
                } else if (aqi <= 100) {
                    aqiDisplay.className = 'aqi-display aqi-moderate';
                    aqiStatus.textContent = 'Moderate Air Quality';
                    aqiDescription.textContent = 'Air quality is acceptable for most people. However, sensitive individuals may experience minor issues.';
                    aqiActions.innerHTML = '<strong>Recommendations:</strong><br>‚Ä¢ Generally safe for outdoor activities<br>‚Ä¢ Sensitive individuals should watch for symptoms<br>‚Ä¢ Consider shorter outdoor exposure if sensitive';
                } else if (aqi <= 150) {
                    aqiDisplay.className = 'aqi-display aqi-unhealthy';
                    aqiStatus.textContent = 'Unhealthy for Sensitive Groups';
                    aqiDescription.textContent = 'Members of sensitive groups may experience health effects. The general public is not likely to be affected.';
                    aqiActions.innerHTML = '<strong>Recommendations:</strong><br>‚Ä¢ Sensitive individuals should limit outdoor exposure<br>‚Ä¢ Consider wearing N95 masks outdoors<br>‚Ä¢ Reduce prolonged or heavy exertion outside';
                } else {
                    aqiDisplay.className = 'aqi-display aqi-hazardous';
                    aqiStatus.textContent = 'Unhealthy Air Quality';
                    aqiDescription.textContent = 'Everyone may begin to experience health effects; members of sensitive groups may experience more serious health effects.';
                    aqiActions.innerHTML = '<strong>Recommendations:</strong><br>‚Ä¢ Everyone should limit outdoor exposure<br>‚Ä¢ <strong>Wear N95 or P100 respirators outdoors</strong><br>‚Ä¢ Avoid outdoor exercise<br>‚Ä¢ Keep windows and doors closed<br>‚Ä¢ Consider evacuation if conditions worsen';
                }
                
            } catch (error) {
                console.error('Error fetching detailed air quality:', error);
            }
        }

        // Update detailed weather alerts
        async function updateDetailedWeatherAlerts() {
            const alertsContainer = document.getElementById('alerts-container');
            const alertCount = document.getElementById('detailed-alert-count');
            
            // Simulate weather alerts
            const mockAlerts = [
                {
                    title: 'Red Flag Warning',
                    severity: 'severe',
                    area: 'Jefferson County',
                    effective: new Date(),
                    expires: new Date(Date.now() + 24 * 60 * 60 * 1000),
                    description: 'Critical fire weather conditions expected with low humidity, high temperatures, and strong winds.',
                    instruction: 'Avoid outdoor burning. Have evacuation plans ready. Monitor local fire conditions closely.'
                }
            ];
            
            // Randomly show alerts
            const showAlerts = Math.random() > 0.7;
            const activeAlerts = showAlerts ? mockAlerts : [];
            
            alertCount.textContent = activeAlerts.length;
            
            if (activeAlerts.length === 0) {
                alertsContainer.innerHTML = `
                    <div class="no-alerts">
                        <div class="no-alerts-icon">‚úÖ</div>
                        <h3>No Active Weather Alerts</h3>
                        <p>No fire weather warnings or watches currently issued for your area.</p>
                    </div>
                `;
            } else {
                alertsContainer.innerHTML = activeAlerts.map(alert => `
                    <div class="alert-card ${alert.severity}">
                        <div class="alert-header">
                            <div class="alert-title">${alert.title}</div>
                            <div class="alert-severity ${alert.severity}">${alert.severity}</div>
                        </div>
                        <div class="alert-meta">
                            ${alert.area} ‚Ä¢ Effective: ${alert.effective.toLocaleDateString()} ‚Ä¢ Expires: ${alert.expires.toLocaleDateString()}
                        </div>
                        <div class="alert-description">
                            ${alert.description}
                        </div>
                        <div class="alert-instruction">
                            ${alert.instruction}
                        </div>
                    </div>
                `).join('');
            }
        }

        // Set indicator status
        function setIndicatorStatus(indicatorId, status) {
            const indicator = document.getElementById(indicatorId);
            if (indicator) {
                indicator.className = `update-indicator ${status}`;
            }
        }

        // Refresh functions
        function refreshFireMap() {
            updateWildfiresData();
        }

        function refreshDetailedWeatherData() {
            updateDetailedWeatherData();
        }

        function refreshDetailedAirQuality() {
            updateDetailedAirQuality();
        }

        function refreshDetailedWeatherAlerts() {
            updateDetailedWeatherAlerts();
        }

        // Location functions
        function useAutoLocation() {
            document.getElementById('auto-location-btn').classList.add('active');
            document.getElementById('manual-location-btn').classList.remove('active');
            document.getElementById('city-selector').style.display = 'none';
            detectUserLocation();
        }

        function toggleCitySelector() {
            const selector = document.getElementById('city-selector');
            const autoBtn = document.getElementById('auto-location-btn');
            const manualBtn = document.getElementById('manual-location-btn');
            
            if (selector.style.display === 'none' || !selector.style.display) {
                selector.style.display = 'block';
                autoBtn.classList.remove('active');
                manualBtn.classList.add('active');
            } else {
                selector.style.display = 'none';
                autoBtn.classList.add('active');
                manualBtn.classList.remove('active');
            }
        }

        function useSelectedCity() {
            const select = document.getElementById('city-select');
            const value = select.value;
            
            if (value) {
                const [lat, lon] = value.split(',');
                currentLatitude = parseFloat(lat);
                currentLongitude = parseFloat(lon);
                
                const cityName = select.options[select.selectedIndex].text;
                currentLocationName = cityName;
                updateLocationDisplay(cityName);
                
                if (fireMap) {
                    fireMap.setView([currentLatitude, currentLongitude], 8);
                    if (userLocationMarker) {
                        userLocationMarker.setLatLng([currentLatitude, currentLongitude]);
                    }
                }
                
                updateAllThreatData();
            }
        }

        // Enhanced affiliate tracking function
        function trackAffiliate(productId, retailer) {
            console.log(`Affiliate click tracked: ${productId} -> ${retailer}`);
            
            if (retailer === 'category') {
                alert(`Redirecting to category page: ${productId}...\n\nIn production, this would:\n‚Ä¢ Show all products in this category\n‚Ä¢ Allow side-by-side comparison\n‚Ä¢ Include user reviews and ratings\n‚Ä¢ Provide detailed specifications`);
            } else {
                alert(`Redirecting to ${retailer} for ${productId}...\n\nIn production, this would:\n‚Ä¢ Track the specific product click\n‚Ä¢ Redirect to the actual product page\n‚Ä¢ Include affiliate tracking parameters\n‚Ä¢ Earn commission if purchase is made`);
            }
            return false;
        }

        function generateWildfirePlan() {
            alert('Generating your personalized wildfire action plan...\n\nThis will include:\n‚Ä¢ Property-specific defense strategies\n‚Ä¢ Evacuation route planning\n‚Ä¢ Equipment recommendations\n‚Ä¢ Emergency contact lists\n‚Ä¢ Seasonal preparation timeline');
        }

        console.log('Enhanced wildfire page loaded with working live data');
    </script>
</body>
</html>
