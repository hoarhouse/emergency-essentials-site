<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com https://api.allorigins.win https://corsproxy.io https://api.codetabs.com https://geocoding-api.open-meteo.com https://air-quality-api.open-meteo.com https://api.open-meteo.com https://api.weather.gov; connect-src 'self' https://fonts.googleapis.com https://api.allorigins.win https://corsproxy.io https://api.codetabs.com https://geocoding-api.open-meteo.com https://air-quality-api.open-meteo.com https://api.open-meteo.com https://api.weather.gov; font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;">
    <title>Wildfire Emergency Preparedness - EmergencyEssentials</title>
    <meta name="description" content="Comprehensive wildfire preparedness guide with defense strategies, evacuation planning, and professional equipment recommendations.">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
           font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000000;
            color: #FFFFFF;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* Header */
        .header {
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 100;
            border-bottom: 1px solid #333333;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            letter-spacing: -0.5px;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 24px;
            align-items: center;
        }
        
        .nav-link {
            color: #CCCCCC;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover,
        .nav-link.active {
            color: #FFFFFF;
        }
        
        /* Hero Section */
        .hero {
            text-align: center;
            padding: 120px 0;
            background: linear-gradient(180deg, #000000 0%, #111111 100%);
            position: relative;
        }
        
        .fire-warning {
            display: inline-block;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #FF4444;
            padding: 8px 16px;
            border-radius: 20px;
            color: #FF4444;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .hero h1 {
            font-size: 72px;
            font-weight: 300;
            margin-bottom: 24px;
            letter-spacing: -2px;
            line-height: 1.1;
        }
        
        .hero p {
            font-size: 24px;
            color: #CCCCCC;
            max-width: 600px;
            margin: 0 auto 40px;
            font-weight: 300;
        }
        
        .threat-level {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: #1a1a1a;
            border: 1px solid #333333;
            padding: 16px 24px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .threat-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #FF4444;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Section Styling */
        .section {
            padding: 100px 0;
        }
        
        .section-title {
            font-size: 56px;
            font-weight: 300;
            text-align: center;
            margin-bottom: 80px;
            color: #FFFFFF;
            letter-spacing: -1px;
        }
        
        /* Critical Actions Timeline */
        .critical-timeline {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 60px;
            margin: 60px 0;
        }
        
        .timeline-header {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .timeline-title {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 16px;
            color: #FFFFFF;
        }
        
        .timeline-subtitle {
            color: #CCCCCC;
            font-size: 18px;
            font-weight: 300;
        }
        
        .timeline-stages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 32px;
        }
        
        .timeline-stage {
            background: #161616;
            border: 1px solid #444444;
            border-left: 4px solid;
            padding: 32px;
            border-radius: 0 8px 8px 0;
            transition: all 0.3s ease;
        }
        
        .timeline-stage:hover {
            background: #242424;
            border-color: #666666;
        }
        
        .timeline-stage.immediate { border-left-color: #FF4444; }
        .timeline-stage.prepare { border-left-color: #FFAA44; }
        .timeline-stage.monitor { border-left-color: #44AAFF; }
        .timeline-stage.evacuate { border-left-color: #FF4444; }
        
        .stage-time {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stage-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #FFFFFF;
        }
        
        .stage-actions {
            color: #CCCCCC;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .stage-actions ul {
            padding-left: 16px;
            margin-top: 8px;
        }
        
        .stage-actions li {
            margin-bottom: 4px;
        }
        
        /* Wildfire-Specific Equipment */
        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 60px;
        }
        
        .equipment-card {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .equipment-card:hover {
            background: #2a2a2a;
            border-color: #555555;
            transform: translateY(-2px);
        }
        
        .equipment-priority {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .equipment-priority.critical {
            background: rgba(255, 68, 68, 0.1);
            color: #FF4444;
            border: 1px solid #FF4444;
        }
        
        .equipment-priority.important {
            background: rgba(255, 170, 68, 0.1);
            color: #FFAA44;
            border: 1px solid #FFAA44;
        }
        
        .equipment-priority.recommended {
            background: rgba(68, 170, 255, 0.1);
            color: #44AAFF;
            border: 1px solid #44AAFF;
        }
        
        .equipment-icon {
            width: 24px;
            height: 24px;
            margin-bottom: 24px;
            stroke: #FFFFFF;
            stroke-width: 1.5;
            fill: none;
        }
        
        .equipment-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #FFFFFF;
        }
        
        .equipment-description {
            color: #CCCCCC;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .equipment-specs {
            font-size: 12px;
            color: #999999;
            background: #161616;
            padding: 12px;
            border-radius: 4px;
            border-left: 2px solid #333333;
        }
        
        .affiliate-link {
            display: inline-block;
            margin-top: 16px;
            background: #FF9900;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: background 0.3s ease;
        }
        
        .affiliate-link:hover {
            background: #E68900;
        }
        
        /* Air Quality Monitor */
        .air-quality {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 40px;
            margin: 40px 0;
            text-align: center;
        }
        
        .location-controls {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .location-display {
            font-size: 16px;
            color: #CCCCCC;
            margin-bottom: 12px;
        }
        
        .location-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .location-btn {
            background: transparent;
            border: 1px solid #666666;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .location-btn:hover {
            background: #666666;
            color: #FFFFFF;
        }
        
        .location-btn.active {
            background: #44AAFF;
            border-color: #44AAFF;
            color: #FFFFFF;
        }
        
        .city-selector {
            margin-top: 12px;
            display: none;
        }
        
        .city-selector select {
            background: #1a1a1a;
            border: 1px solid #666666;
            color: #FFFFFF;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            margin-right: 8px;
        }
        
        .city-selector select:focus {
            outline: none;
            border-color: #44AAFF;
        }
        
        .aqi-display {
            font-size: 64px;
            font-weight: 300;
            margin: 20px 0;
            letter-spacing: -2px;
        }
        
        .aqi-good { color: #44AA44; }
        .aqi-moderate { color: #FFDD44; }
        .aqi-unhealthy { color: #FFAA44; }
        .aqi-hazardous { color: #FF4444; }
        
        .aqi-status {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .aqi-description {
            color: #CCCCCC;
            margin-bottom: 24px;
        }
        
        .aqi-actions {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 6px;
            padding: 20px;
            text-align: left;
        }
        
        .refresh-btn {
            background: transparent;
            border: 1px solid #FFFFFF;
            color: #FFFFFF;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }
        
        .refresh-btn:hover {
            background: #FFFFFF;
            color: #000000;
        }
        
        /* Emergency Contacts */
        .emergency-contacts {
            background: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 60px;
            margin: 60px 0;
        }
        
        .contacts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }
        
        .contact-card {
            background: #161616;
            border: 1px solid #444444;
            border-radius: 8px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .contact-card:hover {
            background: #242424;
            border-color: #666666;
        }
        
        .contact-type {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #999999;
            margin-bottom: 8px;
        }
        
        .contact-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #FFFFFF;
        }
        
        .contact-number {
            font-size: 20px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }
        
        .contact-description {
            font-size: 14px;
            color: #CCCCCC;
            line-height: 1.5;
        }
        
        /* Call to Action */
        .cta-section {
            background: #FFFFFF;
            color: #000000;
            text-align: center;
            padding: 80px 40px;
            border-radius: 8px;
            margin: 80px 0;
        }
        
        .cta-title {
            font-size: 48px;
            font-weight: 300;
            margin-bottom: 16px;
            letter-spacing: -1px;
        }
        
        .cta-subtitle {
            font-size: 20px;
            margin-bottom: 32px;
            color: #666666;
            font-weight: 300;
        }
        
        .cta-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .cta-button {
            background: #000000;
            color: #FFFFFF;
            padding: 16px 32px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .cta-button:hover {
            background: #333333;
        }
        
        .cta-button.secondary {
            background: transparent;
            color: #000000;
            border: 1px solid #000000;
        }
        
        .cta-button.secondary:hover {
            background: #000000;
            color: #FFFFFF;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 48px;
            }
            
            .hero p {
                font-size: 18px;
            }
            
            .section-title {
                font-size: 36px;
            }
            
            .timeline-stages {
                grid-template-columns: 1fr;
            }
            
            .nav {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .cta-title {
                font-size: 32px;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: fadeIn 0.6s ease forwards;
        }
        .weather-alerts {
    background: #1a1a1a;
    border: 1px solid #333333;
    border-radius: 8px;
    padding: 40px;
    margin: 40px 0;
}

.alerts-container {
    margin: 20px 0;
    min-height: 100px;
}

.loading-alerts {
    text-align: center;
    padding: 40px;
    color: #CCCCCC;
}

.alert-card {
    background: #161616;
    border: 1px solid #444444;
    border-left: 4px solid;
    border-radius: 0 8px 8px 0;
    padding: 20px;
    margin-bottom: 16px;
    transition: all 0.3s ease;
}

.alert-card:hover {
    background: #242424;
    border-color: #666666;
}

.alert-card.severe { border-left-color: #FF4444; }
.alert-card.moderate { border-left-color: #FFAA44; }
.alert-card.minor { border-left-color: #FFDD44; }

.alert-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
}

.alert-title {
    font-size: 18px;
    font-weight: 600;
    color: #FFFFFF;
    flex-grow: 1;
}

.alert-severity {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-left: 12px;
}

.alert-severity.severe {
    background: rgba(255, 68, 68, 0.1);
    color: #FF4444;
    border: 1px solid #FF4444;
}

.alert-severity.moderate {
    background: rgba(255, 170, 68, 0.1);
    color: #FFAA44;
    border: 1px solid #FFAA44;
}

.alert-severity.minor {
    background: rgba(255, 221, 68, 0.1);
    color: #FFDD44;
    border: 1px solid #FFDD44;
}

.alert-meta {
    font-size: 12px;
    color: #999999;
    margin-bottom: 12px;
}

.alert-description {
    color: #CCCCCC;
    line-height: 1.6;
    margin-bottom: 12px;
}

.alert-instruction {
    background: #0f0f0f;
    border: 1px solid #333333;
    border-radius: 4px;
    padding: 12px;
    font-size: 14px;
    color: #FFFFFF;
    font-weight: 500;
}

.no-alerts {
    text-align: center;
    padding: 40px;
    color: #CCCCCC;
}

.no-alerts-icon {
    font-size: 48px;
    margin-bottom: 16px;
    color: #44AA44;
}

.alert-count {
    font-size: 14px;
    color: #999999;
    margin-bottom: 12px;
}
        /* Weather Conditions Styling */
.weather-conditions {
    background: #1a1a1a;
    border: 1px solid #333333;
    border-radius: 8px;
    padding: 40px;
    margin: 40px 0;
}

.weather-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.weather-card {
    background: #161616;
    border: 1px solid #444444;
    border-radius: 8px;
    padding: 24px;
    text-align: center;
    transition: all 0.3s ease;
}

.weather-card:hover {
    background: #242424;
    border-color: #666666;
    transform: translateY(-2px);
}

.weather-card.fire-danger {
    border-left: 4px solid #FF4444;
}

.weather-label {
    font-size: 14px;
    color: #CCCCCC;
    margin-bottom: 8px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.weather-value {
    font-size: 36px;
    font-weight: 300;
    color: #FFFFFF;
    margin-bottom: 4px;
    line-height: 1;
}

.weather-unit {
    font-size: 14px;
    color: #999999;
    font-weight: 500;
}

.fire-danger .weather-value {
    font-size: 24px;
    font-weight: 600;
}

.fire-danger-low { color: #44AA44; }
.fire-danger-moderate { color: #FFDD44; }
.fire-danger-high { color: #FFAA44; }
.fire-danger-extreme { color: #FF4444; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="index.html" class="logo">EmergencyEssentials</a>
                <div class="nav-links">
                    <a href="index.html" class="nav-link">All Emergencies</a>
                    <a href="wildfire.html" class="nav-link active">Wildfire</a>
                    <a href="flood.html" class="nav-link">Flood</a>
                    <a href="#" class="nav-link">Power Outage</a>
                    <a href="#" class="nav-link">Earthquake</a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="fire-warning">ðŸ”¥ High Fire Danger</div>
            <h1>Wildfire Preparedness</h1>
            <p>Comprehensive defense strategies for wildfire threats in high-risk areas</p>
            <div class="threat-level">
                <div class="threat-indicator"></div>
                <span>Current Fire Danger: <strong>EXTREME</strong> - Denver Metro Area</span>
            </div>
        </div>
    </section>

    <!-- Critical Actions Timeline -->
    <section class="section">
        <div class="container">
            <div class="critical-timeline">
                <div class="timeline-header">
                    <h2 class="timeline-title">Critical Action Timeline</h2>
                    <p class="timeline-subtitle">Time-sensitive actions based on wildfire proximity and conditions</p>
                </div>
                <div class="timeline-stages">
                    <div class="timeline-stage immediate">
                        <div class="stage-time" style="color: #FF4444;">Fire Spotted (0-30 minutes)</div>
                        <h3 class="stage-title">Immediate Assessment</h3>
                        <div class="stage-actions">
                            Monitor fire location and wind conditions
                            <ul>
                                <li>Check official evacuation alerts</li>
                                <li>Assess escape routes</li>
                                <li>Prepare go-bags</li>
                                <li>Alert family members</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="timeline-stage prepare">
                        <div class="stage-time" style="color: #FFAA44;">Fire Approaching (30-60 minutes)</div>
                        <h3 class="stage-title">Active Preparation</h3>
                        <div class="stage-actions">
                            Implement defensive measures
                            <ul>
                                <li>Close all windows and doors</li>
                                <li>Turn on sprinkler systems</li>
                                <li>Move flammable items away from house</li>
                                <li>Fill bathtubs and containers with water</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="timeline-stage monitor">
                        <div class="stage-time" style="color: #44AAFF;">Standby Mode (1-6 hours)</div>
                        <h3 class="stage-title">Continuous Monitoring</h3>
                        <div class="stage-actions">
                            Stay alert and ready to evacuate
                            <ul>
                                <li>Monitor radio and emergency alerts</li>
                                <li>Watch for ember showers</li>
                                <li>Keep vehicles loaded and ready</li>
                                <li>Maintain communication with authorities</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="timeline-stage evacuate">
                        <div class="stage-time" style="color: #FF4444;">Evacuation Order</div>
                        <h3 class="stage-title">Immediate Evacuation</h3>
                        <div class="stage-actions">
                            Execute evacuation plan immediately
                            <ul>
                                <li>Grab go-bags and essential items</li>
                                <li>Follow designated evacuation routes</li>
                                <li>Check on neighbors if safe to do so</li>
                                <li>Do not return until officially cleared</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Wildfire-Specific Equipment -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Wildfire Defense Equipment</h2>
            <div class="equipment-grid">
                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                    </svg>
                    <h3 class="equipment-title">N95/P100 Respirators</h3>
                    <p class="equipment-description">Essential protection against smoke inhalation during evacuation and fire approach. Multiple masks per family member required.</p>
                    <div class="equipment-specs">
                        Specification: NIOSH-approved N95 minimum, P100 preferred for heavy smoke conditions
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('n95-respirators', 'amazon')">View on Amazon - $24.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-15.355 21.213 0"/>
                    </svg>
                    <h3 class="equipment-title">NOAA Weather Radio</h3>
                    <p class="equipment-description">Hand-crank emergency radio with NOAA weather alerts specifically for fire weather warnings and evacuation orders.</p>
                    <div class="equipment-specs">
                        Specification: SAME alert capability, solar/hand-crank power, battery backup
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('noaa-weather-radio', 'amazon')">View on Amazon - $39.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority critical">Critical</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                    <h3 class="equipment-title">High-Output LED Flashlights</h3>
                    <p class="equipment-description">Powerful LED flashlights for navigation during smoke-obscured evacuations. Multiple units with extra batteries essential.</p>
                    <div class="equipment-specs">
                        Specification: 1000+ lumens, multiple light modes, waterproof IPX7 rating
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('led-flashlight', 'amazon')">View on Amazon - $32.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority important">Important</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                    </svg>
                    <h3 class="equipment-title">Emergency Sprinkler System</h3>
                    <p class="equipment-description">Portable sprinkler heads and hoses for roof and perimeter protection against ember showers and radiant heat.</p>
                    <div class="equipment-specs">
                        Specification: 360-degree coverage, metal construction, 50+ foot hose reach
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('sprinkler-system', 'amazon')">View on Amazon - $89.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority important">Important</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                    <h3 class="equipment-title">Fire-Resistant Blankets</h3>
                    <p class="equipment-description">Wool or specially treated fire-resistant blankets for emergency shelter and protection during last-resort situations.</p>
                    <div class="equipment-specs">
                        Specification: 100% wool or fire-retardant treated material, large enough to cover 2 people
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('fire-blanket', 'amazon')">View on Amazon - $45.99</a>
                </div>

                <div class="equipment-card">
                    <div class="equipment-priority recommended">Recommended</div>
                    <svg class="equipment-icon" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    <h3 class="equipment-title">Portable Generator</h3>
                    <p class="equipment-description">Backup power for well pumps, communication devices, and essential systems during power outages common with wildfires.</p>
                    <div class="equipment-specs">
                        Specification: 3000W minimum, fuel storage, proper ventilation setup for outdoor use
                    </div>
                    <a href="#" class="affiliate-link" onclick="trackAffiliate('portable-generator', 'amazon')">View on Amazon - $449.99</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Detailed Weather Conditions -->
<section class="section">
    <div class="container">
        <div class="weather-conditions">
            <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Current Fire Weather Conditions</h2>
            
            <div class="location-controls">
                <div class="location-display">Location: <span id="weather-current-location">Detecting your location...</span></div>
            </div>
            
            <div class="weather-grid">
                <div class="weather-card">
                    <div class="weather-label">Temperature</div>
                    <div class="weather-value" id="current-temp">Loading...</div>
                    <div class="weather-unit">Â°F</div>
                </div>
                
                <div class="weather-card">
                    <div class="weather-label">Humidity</div>
                    <div class="weather-value" id="current-humidity">Loading...</div>
                    <div class="weather-unit">%</div>
                </div>
                
                <div class="weather-card">
                    <div class="weather-label">Wind Speed</div>
                    <div class="weather-value" id="current-wind-speed">Loading...</div>
                    <div class="weather-unit">mph</div>
                </div>
                
                <div class="weather-card">
                    <div class="weather-label">Wind Direction</div>
                    <div class="weather-value" id="current-wind-direction">Loading...</div>
                    <div class="weather-unit">Â°</div>
                </div>
                
                <div class="weather-card fire-danger">
                    <div class="weather-label">Fire Danger Index</div>
                    <div class="weather-value" id="fire-danger-index">Calculating...</div>
                    <div class="weather-unit" id="fire-danger-level">Risk Level</div>
                </div>
            </div>
            
            <button class="refresh-btn" onclick="refreshWeatherData()">Refresh Weather</button>
        </div>
    </div>
</section>

    <!-- Air Quality Monitor -->
    <section class="section">
        <div class="container">
            <div class="air-quality">
                <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Current Air Quality</h2>
                
                <div class="location-controls">
                    <div class="location-display">Location: <span id="current-location">Detecting your location...</span></div>
                    <div class="location-buttons">
                        <button class="location-btn active" id="auto-location-btn" onclick="useAutoLocation()">Use My Location</button>
                        <button class="location-btn" id="manual-location-btn" onclick="toggleCitySelector()">Choose City</button>
                    </div>
                    <div class="city-selector" id="city-selector">
                        <select id="city-select" onchange="useSelectedCity()">
                            <option value="">Select a city...</option>
                            <option value="33.4484,-112.0740">Phoenix, AZ</option>
                            <option value="34.0522,-118.2437">Los Angeles, CA</option>
                            <option value="37.7749,-122.4194">San Francisco, CA</option>
                            <option value="38.5816,-121.4944">Sacramento, CA</option>
                            <option value="39.7392,-104.9903">Denver, CO</option>
                            <option value="41.2033,-77.1945">Pennsylvania</option>
                            <option value="43.6532,-116.3113">Boise, ID</option>
                            <option value="41.8781,-87.6298">Chicago, IL</option>
                            <option value="39.7817,-86.1478">Indianapolis, IN</option>
                            <option value="38.2904,-92.6390">Missouri</option>
                            <option value="46.8772,-96.7898">Fargo, ND</option>
                            <option value="36.1627,-86.7816">Nashville, TN</option>
                            <option value="30.2672,-97.7431">Austin, TX</option>
                            <option value="32.7767,-96.7970">Dallas, TX</option>
                            <option value="29.7604,-95.3698">Houston, TX</option>
                            <option value="40.7608,-111.8910">Salt Lake City, UT</option>
                            <option value="47.0379,-122.9015">Olympia, WA</option>
                            <option value="47.6062,-122.3321">Seattle, WA</option>
                        </select>
                        <button class="location-btn" onclick="useSelectedCity()">Update</button>
                    </div>
                </div>
                
                <div class="aqi-display aqi-moderate">Loading...</div>
                <div class="aqi-status">Checking conditions...</div>
                <p class="aqi-description">Fetching real-time air quality data for your area</p>
                <div class="aqi-actions">
                    <strong>Loading current recommendations...</strong><br>
                    Please wait while we fetch the latest air quality data from Open-Meteo.
                </div>
                <button class="refresh-btn" onclick="refreshAirQuality()">Refresh Data</button>
            </div>
        </div>
    </section>
    
    <!-- Fire Weather Alerts -->
<section class="section">
    <div class="container">
        <div class="weather-alerts">
            <h2 style="color: #FFFFFF; margin-bottom: 16px; font-weight: 300;">Fire Weather Alerts</h2>
            
            <div class="location-controls">
                <div class="location-display">Location: <span id="weather-location">Detecting your location...</span></div>
                <div class="alert-count">Active Alerts: <span id="alert-count">Loading...</span></div>
            </div>
            
            <div id="alerts-container" class="alerts-container">
                <div class="loading-alerts">
                    <div style="font-size: 18px; margin-bottom: 8px;">Checking for active weather alerts...</div>
                    <div style="color: #CCCCCC;">Fetching official fire weather warnings from National Weather Service</div>
                </div>
            </div>
            
            <button class="refresh-btn" onclick="refreshWeatherAlerts()">Refresh Alerts</button>
        </div>
    </div>
</section>

    <!-- Emergency Contacts -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Critical Emergency Contacts</h2>
            <div class="emergency-contacts">
                <div class="contacts-grid">
                    <div class="contact-card">
                        <div class="contact-type">Emergency Services</div>
                        <div class="contact-name">Fire Department</div>
                        <div class="contact-number">911</div>
                        <div class="contact-description">For immediate life-threatening emergencies and active fire reports</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Evacuation Info</div>
                        <div class="contact-name">Jefferson County Sheriff</div>
                        <div class="contact-number">(303) 277-0211</div>
                        <div class="contact-description">Non-emergency line for evacuation status and road closures</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Fire Information</div>
                        <div class="contact-name">CO Fire Information</div>
                        <div class="contact-number">(303) 275-5360</div>
                        <div class="contact-description">Current fire conditions, restrictions, and weather updates</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Utilities Emergency</div>
                        <div class="contact-name">Xcel Energy</div>
                        <div class="contact-number">(800) 895-1999</div>
                        <div class="contact-description">Report power lines down or request emergency shutoffs</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Red Cross Shelter</div>
                        <div class="contact-name">American Red Cross</div>
                        <div class="contact-number">(303) 722-7474</div>
                        <div class="contact-description">Emergency shelter locations and disaster relief services</div>
                    </div>
                    
                    <div class="contact-card">
                        <div class="contact-type">Animal Services</div>
                        <div class="contact-name">Jefferson County Animal Control</div>
                        <div class="contact-number">(303) 271-5070</div>
                        <div class="contact-description">Emergency pet sheltering and large animal evacuation</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="section">
        <div class="container">
            <div class="cta-section">
                <h2 class="cta-title">Create Your Wildfire Action Plan</h2>
                <p class="cta-subtitle">Generate a customized wildfire preparedness plan for your specific location and risk level</p>
                <div class="cta-buttons">
                    <button class="cta-button" onclick="generateWildfirePlan()">Generate Plan</button>
                    <a href="#" class="cta-button secondary">Download Checklist</a>
                    <a href="#" class="cta-button secondary">Find Local Resources</a>
                </div>
            </div>
        </div>
    </section>

    </script>
    <script>
        // Generate wildfire plan functionality
        function generateWildfirePlan() {
            alert('Generating your personalized wildfire action plan...\n\nThis will include:\nâ€¢ Property-specific defense strategies\nâ€¢ Evacuation route planning\nâ€¢ Equipment recommendations\nâ€¢ Emergency contact lists\nâ€¢ Seasonal preparation timeline');
        }

        // Affiliate tracking function
        function trackAffiliate(productId, retailer) {
            console.log(`Affiliate click tracked: ${productId} -> ${retailer}`);
            alert(`Redirecting to ${retailer} for ${productId}...\n\nIn production, this would:\nâ€¢ Track the affiliate click\nâ€¢ Redirect to the actual product page\nâ€¢ Earn commission if purchase is made`);
            return false;
        }

        // REAL Air Quality API Integration with Open-Meteo - Location Aware
        let currentLatitude = 39.7392; // Default to Denver
        let currentLongitude = -104.9903;
        let currentLocationName = 'Denver, CO';
        let usingAutoLocation = true;

        // Auto-detect user location on page load
        async function detectUserLocation() {
           if (!navigator.geolocation) {
    console.log('Geolocation not supported');
    updateLocationDisplay('Denver, CO (Default)');
    updateAirQuality();
              updateWeatherDataLocation(); // FIXED: Added this line
    return;
            }

            try {
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, {
                        timeout: 10000,
                        enableHighAccuracy: true
                    });
                });

                currentLatitude = position.coords.latitude;
                currentLongitude = position.coords.longitude;
                
                // Get city name from coordinates using reverse geocoding
                const locationName = await getCityName(currentLatitude, currentLongitude);
                currentLocationName = locationName;
                updateLocationDisplay(locationName);
                
                console.log(`Location detected: ${locationName} (${currentLatitude}, ${currentLongitude})`);
                
                // Update air quality for detected location
                updateAirQuality();
                updateWeatherAlertsLocation(); // FIXED: Added this line
                updateWeatherDataLocation(); // FIXED: Added this line for weather data
                
            } catch (error) {
    console.log('Location detection failed:', error.message);
    updateLocationDisplay('Denver, CO (Default - Location Access Denied)');
    updateAirQuality();
                updateWeatherAlertsLocation();
                updateWeatherDataLocation();

    showCitySelector();
}
        }

        // Get city name from coordinates
        async function getCityName(lat, lon) {
            try {
                const response = await fetch(`https://geocoding-api.open-meteo.com/v1/reverse?latitude=${lat}&longitude=${lon}&count=1`);
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const result = data.results[0];
                    const city = result.name || result.admin1 || 'Unknown City';
                    const state = result.admin1 || result.country_code || '';
                    return state ? `${city}, ${state}` : city;
                }
                return 'Your Location';
            } catch (error) {
                console.error('Reverse geocoding failed:', error);
                return 'Your Location';
            }
        }

        // Update location display
       // Update location display
        function updateLocationDisplay(locationName) {
            document.getElementById('current-location').textContent = locationName;
            // Also update weather location displays
            const weatherLocation = document.getElementById('weather-current-location');
            if (weatherLocation) {
                weatherLocation.textContent = locationName;
            }
            const alertsLocation = document.getElementById('weather-location');
            if (alertsLocation) {
                alertsLocation.textContent = locationName;
            }
        }

        // Show city selector
        function showCitySelector() {
            document.getElementById('city-selector').style.display = 'block';
            document.getElementById('manual-location-btn').classList.add('active');
            document.getElementById('auto-location-btn').classList.remove('active');
            usingAutoLocation = false;
        }

        // Hide city selector
        function hideCitySelector() {
            document.getElementById('city-selector').style.display = 'none';
            document.getElementById('auto-location-btn').classList.add('active');
            document.getElementById('manual-location-btn').classList.remove('active');
            usingAutoLocation = true;
        }

        // Toggle city selector
        function toggleCitySelector() {
            if (document.getElementById('city-selector').style.display === 'none') {
                showCitySelector();
            } else {
                hideCitySelector();
            }
        }

        // Use auto location
        function useAutoLocation() {
            hideCitySelector();
            updateLocationDisplay('Detecting your location...');
            detectUserLocation();
        }

        // Use selected city
        function useSelectedCity() {
            const select = document.getElementById('city-select');
            const selectedValue = select.value;
            
            if (!selectedValue) return;
            
            const [lat, lon] = selectedValue.split(',');
            currentLatitude = parseFloat(lat);
            currentLongitude = parseFloat(lon);
            
            const selectedText = select.options[select.selectedIndex].text;
            currentLocationName = selectedText;
            updateLocationDisplay(selectedText);
            
            usingAutoLocation = false;
            updateAirQuality();
            updateWeatherAlertsLocation(); // FIXED: Added this line
            updateWeatherDataLocation();
            updateWeatherDataLocation(); // FIXED: Added this line
        }

        async function updateAirQuality() {
            try {
                // Open-Meteo Air Quality API call (completely free, no API key needed)
                const response = await fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${currentLatitude}&longitude=${currentLongitude}&current=us_aqi&timezone=auto`);
                
                if (!response.ok) {
                    throw new Error('Failed to fetch air quality data');
                }
                
                const data = await response.json();
                
                // Get current AQI value
                const currentAQI = data.current.us_aqi;
                
                // Update the display elements
                const display = document.querySelector('.aqi-display');
                const status = document.querySelector('.aqi-status');
                const description = document.querySelector('.aqi-description');
                const actions = document.querySelector('.aqi-actions');
                
                // Update AQI number
                display.textContent = currentAQI;
                
                // Reset classes
                display.className = 'aqi-display';
                
                // Set status and color based on AQI value
                if (currentAQI <= 50) {
                    display.classList.add('aqi-good');
                    status.textContent = 'Good';
                    description.textContent = 'Air quality is satisfactory for most people.';
                    actions.innerHTML = `
                        <strong>Current Recommendations:</strong><br>
                        â€¢ Enjoy outdoor activities<br>
                        â€¢ Normal ventilation is fine<br>
                        â€¢ No special precautions needed<br>
                        â€¢ Good conditions for exercise
                    `;
                } else if (currentAQI <= 100) {
                    display.classList.add('aqi-moderate');
                    status.textContent = 'Moderate';
                    description.textContent = 'Air quality is acceptable for most people, sensitive individuals may experience minor issues.';
                    actions.innerHTML = `
                        <strong>Current Recommendations:</strong><br>
                        â€¢ Unusually sensitive people should limit outdoor exertion<br>
                        â€¢ Generally safe for outdoor activities<br>
                        â€¢ Consider reducing time outdoors if sensitive<br>
                        â€¢ Monitor conditions if planning extended outdoor time
                    `;
                } else if (currentAQI <= 150) {
                    display.classList.add('aqi-unhealthy');
                    status.textContent = 'Unhealthy for Sensitive Groups';
                    description.textContent = 'Sensitive groups may experience health effects. General public less likely to be affected.';
                    actions.innerHTML = `
                        <strong>Current Recommendations:</strong><br>
                        â€¢ Sensitive groups should limit outdoor exertion<br>
                        â€¢ Children and elderly should stay indoors<br>
                        â€¢ Consider wearing N95 masks if going outside<br>
                        â€¢ Keep windows closed, use air purifiers
                    `;
                } else if (currentAQI <= 200) {
                    display.classList.add('aqi-unhealthy');
                    status.textContent = 'Unhealthy';
                    description.textContent = 'Everyone may begin to experience health effects. Sensitive groups may experience more serious effects.';
                    actions.innerHTML = `
                        <strong>Current Recommendations:</strong><br>
                        â€¢ Everyone should limit outdoor exertion<br>
                        â€¢ Wear N95 masks when outside<br>
                        â€¢ Keep windows and doors closed<br>
                        â€¢ Use air purifiers indoors if available
                    `;
                } else if (currentAQI <= 300) {
                    display.classList.add('aqi-hazardous');
                    status.textContent = 'Very Unhealthy';
                    description.textContent = 'Health warnings of emergency conditions. Everyone more likely to be affected.';
                    actions.innerHTML = `
                        <strong>Current Recommendations:</strong><br>
                        â€¢ Avoid all outdoor activities<br>
                        â€¢ Stay indoors with windows closed<br>
                        â€¢ Use high-efficiency air purifiers<br>
                        â€¢ Wear N95+ masks if you must go outside
                    `;
                } else {
                    display.classList.add('aqi-hazardous');
                    status.textContent = 'Hazardous';
                    description.textContent = 'Health alert: everyone may experience serious health effects.';
                    actions.innerHTML = `
                        <strong>EMERGENCY CONDITIONS:</strong><br>
                        â€¢ Stay indoors at all times<br>
                        â€¢ Seal gaps around doors and windows<br>
                        â€¢ Run air purifiers on high<br>
                        â€¢ Seek medical attention if experiencing symptoms
                    `;
                }
                
                console.log(`Air quality updated for ${currentLocationName}: AQI ${currentAQI}`);
                
            } catch (error) {
                console.error('Error fetching air quality data:', error);
                
                // Fallback to show an error message
                const display = document.querySelector('.aqi-display');
                const status = document.querySelector('.aqi-status');
                const description = document.querySelector('.aqi-description');
                const actions = document.querySelector('.aqi-actions');
                
                display.textContent = '---';
                display.className = 'aqi-display';
                status.textContent = 'Data Unavailable';
                description.textContent = 'Unable to fetch current air quality data. Please check your connection.';
                actions.innerHTML = `
                    <strong>Service Temporarily Unavailable:</strong><br>
                    â€¢ Try refreshing in a few minutes<br>
                    â€¢ Check local news for air quality updates<br>
                    â€¢ Follow general wildfire safety precautions<br>
                    â€¢ Contact local authorities for current conditions
                `;
            }
        }

        // Manual refresh function
        function refreshAirQuality() {
            const status = document.querySelector('.aqi-status');
            status.textContent = 'Refreshing...';
            
            updateAirQuality().then(() => {
                // Success handled in updateAirQuality function
            }).catch(() => {
                // Error handled in updateAirQuality function
            });
        }

        // Update every 30 minutes (1800000 milliseconds) - reasonable for air quality
        setInterval(updateAirQuality, 1800000);

        // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Animate elements on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.equipment-card, .contact-card, .timeline-stage').forEach(el => {
            observer.observe(el);
        });

        // Emergency contact click to call (on mobile)
        document.querySelectorAll('.contact-number').forEach(number => {
            number.addEventListener('click', function() {
                if (/Mobi|Android/i.test(navigator.userAgent)) {
                    window.location.href = 'tel:' + this.textContent.replace(/\D/g, '');
                }
            });
        });
// Weather alerts variables
        let weatherLatitude = 39.7392; // Default to Denver
        let weatherLongitude = -104.9903;
        let weatherLocationName = 'Denver, CO';

        // Initialize location detection when page loads
document.addEventListener('DOMContentLoaded', function() {
    detectUserLocation();
    updateWeatherData(); // Initialize weather data
});

        // Get state abbreviation from coordinates
        async function getStateFromCoords(lat, lon) {
            try {
                const response = await fetch(`https://geocoding-api.open-meteo.com/v1/reverse?latitude=${lat}&longitude=${lon}&count=1`);
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const result = data.results[0];
                    // Try to get state abbreviation from admin1
                    const admin1 = result.admin1;
                    
                    // Convert full state names to abbreviations
                    const stateAbbreviations = {
                        'Alabama': 'AL', 'Alaska': 'AK', 'Arizona': 'AZ', 'Arkansas': 'AR', 'California': 'CA',
                        'Colorado': 'CO', 'Connecticut': 'CT', 'Delaware': 'DE', 'Florida': 'FL', 'Georgia': 'GA',
                        'Hawaii': 'HI', 'Idaho': 'ID', 'Illinois': 'IL', 'Indiana': 'IN', 'Iowa': 'IA',
                        'Kansas': 'KS', 'Kentucky': 'KY', 'Louisiana': 'LA', 'Maine': 'ME', 'Maryland': 'MD',
                        'Massachusetts': 'MA', 'Michigan': 'MI', 'Minnesota': 'MN', 'Mississippi': 'MS', 'Missouri': 'MO',
                        'Montana': 'MT', 'Nebraska': 'NE', 'Nevada': 'NV', 'New Hampshire': 'NH', 'New Jersey': 'NJ',
                        'New Mexico': 'NM', 'New York': 'NY', 'North Carolina': 'NC', 'North Dakota': 'ND', 'Ohio': 'OH',
                        'Oklahoma': 'OK', 'Oregon': 'OR', 'Pennsylvania': 'PA', 'Rhode Island': 'RI', 'South Carolina': 'SC',
                        'South Dakota': 'SD', 'Tennessee': 'TN', 'Texas': 'TX', 'Utah': 'UT', 'Vermont': 'VT',
                        'Virginia': 'VA', 'Washington': 'WA', 'West Virginia': 'WV', 'Wisconsin': 'WI', 'Wyoming': 'WY'
                    };
                    
                    // Return abbreviation if found, otherwise return admin1 as is
                    return stateAbbreviations[admin1] || admin1 || 'CO';
                }
                return 'CO'; // Default to Colorado
            } catch (error) {
                console.error('Error getting state from coordinates:', error);
                return 'CO'; // Default to Colorado
            }
        }

        // Update weather alerts location when main location changes
        function updateWeatherAlertsLocation() {
            weatherLatitude = currentLatitude;
            weatherLongitude = currentLongitude;
            weatherLocationName = currentLocationName;
            document.getElementById('weather-location').textContent = weatherLocationName;
            updateWeatherAlerts();
        }

       // Main weather alerts function - REAL DATA ONLY
        async function updateWeatherAlerts() {
            const alertsContainer = document.getElementById('alerts-container');
            const alertCount = document.getElementById('alert-count');
            
            try {
                // Get state abbreviation for the location
                const state = await getStateFromCoords(weatherLatitude, weatherLongitude);
                
                // Try multiple CORS proxy services in order of reliability
                const proxies = [
                    'https://api.allorigins.win/get?url=',
                    'https://corsproxy.io/?',
                    'https://api.codetabs.com/v1/proxy?quest='
                ];
                
                let data = null;
                let lastError = null;
                
                for (const proxyUrl of proxies) {
                    try {
                        const targetUrl = `https://api.weather.gov/alerts/active?area=${state}`;
                        const response = await fetch(proxyUrl + encodeURIComponent(targetUrl), {
                            headers: {
                                'Accept': 'application/json',
                                'User-Agent': 'EmergencyEssentials-Web-App'
                            }
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        }
                        
                        const result = await response.json();
                        
                        // Handle different proxy response formats
                        if (result.contents) {
                            // allorigins format
                            data = JSON.parse(result.contents);
                        } else if (result.features) {
                            // Direct format
                            data = result;
                        } else {
                            throw new Error('Unexpected response format');
                        }
                        
                        console.log(`Successfully fetched alerts via ${proxyUrl}`);
                        break;
                        
                    } catch (error) {
                        lastError = error;
                        console.warn(`Proxy ${proxyUrl} failed: ${error.message}`);
                        continue;
                    }
                }
                
                if (!data) {
                    throw new Error(`All proxy services failed. Last error: ${lastError?.message}`);
                }
                
                const alerts = data.features || [];
                
                // Filter for fire/weather related alerts
                const fireWeatherAlerts = alerts.filter(alert => {
                    const event = alert.properties.event.toLowerCase();
                    const description = (alert.properties.description || '').toLowerCase();
                    
                    return event.includes('fire') || 
                           event.includes('wind') || 
                           event.includes('red flag') ||
                           event.includes('heat') ||
                           event.includes('drought') ||
                           description.includes('fire weather') ||
                           description.includes('red flag') ||
                           description.includes('wildfire') ||
                           description.includes('extreme fire');
                });
                
                // Update alert count
                alertCount.textContent = fireWeatherAlerts.length;
                
                // Render alerts
                renderWeatherAlerts(fireWeatherAlerts);
                
                console.log(`Weather alerts updated for ${weatherLocationName}: ${fireWeatherAlerts.length} fire weather alerts`);
                
            } catch (error) {
                console.error('All attempts to fetch weather alerts failed:', error);
                
                // Show service unavailable message - NO DEMO DATA
                alertCount.textContent = 'Service Unavailable';
                alertsContainer.innerHTML = `
                    <div class="loading-alerts">
                        <div style="font-size: 18px; margin-bottom: 8px; color: #FF4444;">Weather Alert Service Unavailable</div>
                        <div style="color: #CCCCCC; margin-bottom: 16px;">
                            Unable to connect to National Weather Service API. This may be due to:
                            <br>â€¢ API server maintenance
                            <br>â€¢ Network connectivity issues  
                            <br>â€¢ Service rate limiting
                        </div>
                        <div style="background: #161616; border: 1px solid #444444; border-radius: 4px; padding: 12px; font-size: 14px;">
                            <strong>Alternative Sources:</strong><br>
                            â€¢ Visit <a href="https://weather.gov" target="_blank" style="color: #44AAFF;">weather.gov</a> directly<br>
                            â€¢ Check local emergency management websites<br>
                            â€¢ Monitor local news and radio for fire weather warnings
                        </div>
                    </div>
                `;
            }
        }
        // Render weather alerts in the UI
        function renderWeatherAlerts(alerts) {
            const container = document.getElementById('alerts-container');
            
            if (alerts.length === 0) {
                container.innerHTML = `
                    <div class="no-alerts">
                        <div class="no-alerts-icon">âœ…</div>
                        <div style="font-size: 18px; margin-bottom: 8px; color: #44AA44;">No Fire Weather Alerts</div>
                        <div>No active fire weather warnings or watches for your area.</div>
                    </div>
                `;
                return;
            }
            
            let alertsHTML = '';
            
            alerts.forEach(alert => {
                const properties = alert.properties;
                const severity = getSeverityClass(properties.severity, properties.event);
                const severityLabel = properties.severity || 'Minor';
                
                // Format dates
                const startTime = new Date(properties.onset || properties.sent).toLocaleString();
                const endTime = properties.ends ? new Date(properties.ends).toLocaleString() : 'Until further notice';
                
                alertsHTML += `
                    <div class="alert-card ${severity}">
                        <div class="alert-header">
                            <div class="alert-title">${properties.event}</div>
                            <div class="alert-severity ${severity}">${severityLabel}</div>
                        </div>
                        <div class="alert-meta">
                            <strong>Effective:</strong> ${startTime}<br>
                            <strong>Expires:</strong> ${endTime}<br>
                            <strong>Areas:</strong> ${properties.areaDesc}
                        </div>
                        <div class="alert-description">
                            ${properties.description}
                        </div>
                        ${properties.instruction ? `
                            <div class="alert-instruction">
                                <strong>Recommended Actions:</strong><br>
                                ${properties.instruction}
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            container.innerHTML = alertsHTML;
        }

        // Determine severity class based on alert properties
        function getSeverityClass(severity, event) {
            const eventLower = event.toLowerCase();
            
            // High priority fire weather events
            if (eventLower.includes('red flag warning') || 
                eventLower.includes('fire warning') ||
                eventLower.includes('extreme fire') ||
                severity === 'Extreme' || 
                severity === 'Severe') {
                return 'severe';
            }
            
            // Moderate priority
            if (eventLower.includes('red flag watch') || 
                eventLower.includes('fire weather watch') ||
                eventLower.includes('wind advisory') ||
                severity === 'Moderate') {
                return 'moderate';
            }
            
            // Lower priority
            return 'minor';
        }

        // Manual refresh function
        function refreshWeatherAlerts() {
            document.getElementById('alert-count').textContent = 'Loading...';
            document.getElementById('alerts-container').innerHTML = `
                <div class="loading-alerts">
                    <div style="font-size: 18px; margin-bottom: 8px;">Refreshing weather alerts...</div>
                    <div style="color: #CCCCCC;">Fetching latest data from National Weather Service</div>
                </div>
            `;
            updateWeatherAlerts();
        }

        // Update weather alerts every 15 minutes
        setInterval(updateWeatherAlerts, 900000);
        // Weather data variables
let weatherLatitudeData = 39.7392;
let weatherLongitudeData = -104.9903;
let weatherLocationNameData = 'Denver, CO';

// Update weather data location when main location changes
function updateWeatherDataLocation() {
    weatherLatitudeData = currentLatitude;
    weatherLongitudeData = currentLongitude;
    weatherLocationNameData = currentLocationName;
    
    const weatherLocationElement = document.getElementById('weather-current-location');
    if (weatherLocationElement) {
        weatherLocationElement.textContent = weatherLocationNameData;
    }
    
    updateWeatherData();
}

// Main weather data function
async function updateWeatherData() {
    try {
        const response = await fetch(`https://api.open-meteo.com/v1/current?latitude=${weatherLatitudeData}&longitude=${weatherLongitudeData}&current=temperature_2m,relative_humidity_2m,wind_speed_10m,wind_direction_10m&temperature_unit=fahrenheit&wind_speed_unit=mph&timezone=auto`);
        
        if (!response.ok) {
            throw new Error('Failed to fetch weather data');
        }
        
        const data = await response.json();
        const current = data.current;
        
        document.getElementById('current-temp').textContent = Math.round(current.temperature_2m);
        document.getElementById('current-humidity').textContent = Math.round(current.relative_humidity_2m);
        document.getElementById('current-wind-speed').textContent = Math.round(current.wind_speed_10m);
        
        const windDirection = getWindDirection(current.wind_direction_10m);
        document.getElementById('current-wind-direction').textContent = windDirection;
        
        const fireDanger = calculateFireDanger(current.temperature_2m, current.relative_humidity_2m, current.wind_speed_10m);
        document.getElementById('fire-danger-index').textContent = fireDanger.level;
        document.getElementById('fire-danger-level').textContent = fireDanger.description;
        
        const fireDangerCard = document.querySelector('.fire-danger .weather-value');
        fireDangerCard.className = 'weather-value fire-danger-' + fireDanger.class;
        
    } catch (error) {
        console.error('Error fetching weather data:', error);
        document.getElementById('current-temp').textContent = '--';
        document.getElementById('current-humidity').textContent = '--';
        document.getElementById('current-wind-speed').textContent = '--';
        document.getElementById('current-wind-direction').textContent = '--';
        document.getElementById('fire-danger-index').textContent = 'Error';
        document.getElementById('fire-danger-level').textContent = 'Data Unavailable';
    }
}

function getWindDirection(degrees) {
    const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
    const index = Math.round(degrees / 22.5) % 16;
    return directions[index] + ' (' + Math.round(degrees) + 'Â°)';
}

function calculateFireDanger(temp, humidity, windSpeed) {
    let score = 0;
    
    if (temp >= 90) score += 40;
    else if (temp >= 80) score += 30;
    else if (temp >= 70) score += 20;
    else if (temp >= 60) score += 10;
    
    if (humidity <= 15) score += 40;
    else if (humidity <= 25) score += 30;
    else if (humidity <= 35) score += 20;
    else if (humidity <= 50) score += 10;
    
    if (windSpeed >= 25) score += 20;
    else if (windSpeed >= 15) score += 15;
    else if (windSpeed >= 10) score += 10;
    else if (windSpeed >= 5) score += 5;
    
    if (score >= 80) return { level: 'EXTREME', description: 'Critical Fire Weather', class: 'extreme' };
    else if (score >= 60) return { level: 'HIGH', description: 'Dangerous Conditions', class: 'high' };
    else if (score >= 40) return { level: 'MODERATE', description: 'Elevated Risk', class: 'moderate' };
    else return { level: 'LOW', description: 'Minimal Risk', class: 'low' };
}

function refreshWeatherData() {
    document.getElementById('current-temp').textContent = 'Loading...';
    document.getElementById('fire-danger-index').textContent = 'Calculating...';
    updateWeatherData();
}

setInterval(updateWeatherData, 600000);
    </script>
</body>
</html>
